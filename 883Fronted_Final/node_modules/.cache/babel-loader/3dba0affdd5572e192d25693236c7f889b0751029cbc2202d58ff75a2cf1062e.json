{"ast":null,"code":"import _regenerator from \"D:/883vue1/fronted-merge_fronted/883Fronted_Final/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _objectSpread from \"D:/883vue1/fronted-merge_fronted/883Fronted_Final/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"D:/883vue1/fronted-merge_fronted/883Fronted_Final/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.date.to-json.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.url-search-params.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\n// API请求工具类\nvar BASE_URL = 'http://127.0.0.1:8081';\n\n/**\r\n * 通用请求方法\r\n * @param {string} url - 请求路径\r\n * @param {object} options - 请求选项\r\n * @returns {Promise} 响应数据\r\n */\nfunction request(_x) {\n  return _request.apply(this, arguments);\n}\n/**\r\n * GET请求\r\n */\nfunction _request() {\n  _request = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2(url) {\n    var options,\n      token,\n      defaultOptions,\n      config,\n      _result$msg,\n      _result$msg2,\n      response,\n      contentType,\n      result,\n      _args2 = arguments,\n      _t;\n    return _regenerator().w(function (_context2) {\n      while (1) switch (_context2.p = _context2.n) {\n        case 0:\n          options = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : {};\n          token = localStorage.getItem('token');\n          defaultOptions = {\n            headers: _objectSpread({\n              'Content-Type': 'application/json'\n            }, token && {\n              token: token\n            })\n          };\n          config = _objectSpread(_objectSpread(_objectSpread({}, defaultOptions), options), {}, {\n            headers: _objectSpread(_objectSpread({}, defaultOptions.headers), options.headers || {})\n          });\n          _context2.p = 1;\n          _context2.n = 2;\n          return fetch(\"\".concat(BASE_URL).concat(url), config);\n        case 2:\n          response = _context2.v;\n          // 处理非JSON响应\n          contentType = response.headers.get('content-type');\n          if (!(!contentType || !contentType.includes('application/json'))) {\n            _context2.n = 4;\n            break;\n          }\n          if (!response.ok) {\n            _context2.n = 3;\n            break;\n          }\n          return _context2.a(2, {\n            code: 1,\n            msg: 'success',\n            data: null\n          });\n        case 3:\n          throw new Error(\"\\u8BF7\\u6C42\\u5931\\u8D25: \".concat(response.status));\n        case 4:\n          _context2.n = 5;\n          return response.json();\n        case 5:\n          result = _context2.v;\n          if (!(result.code === 0 && ((_result$msg = result.msg) !== null && _result$msg !== void 0 && _result$msg.includes('token') || (_result$msg2 = result.msg) !== null && _result$msg2 !== void 0 && _result$msg2.includes('登录')))) {\n            _context2.n = 6;\n            break;\n          }\n          localStorage.removeItem('token');\n          localStorage.removeItem('userInfo');\n          if (window.location.pathname !== '/login') {\n            window.location.href = '/login';\n          }\n          throw new Error(result.msg || '登录已过期，请重新登录');\n        case 6:\n          return _context2.a(2, result);\n        case 7:\n          _context2.p = 7;\n          _t = _context2.v;\n          console.error('请求错误:', _t);\n          throw _t;\n        case 8:\n          return _context2.a(2);\n      }\n    }, _callee2, null, [[1, 7]]);\n  }));\n  return _request.apply(this, arguments);\n}\nexport function get(url) {\n  var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var queryString = new URLSearchParams(params).toString();\n  var fullUrl = queryString ? \"\".concat(url, \"?\").concat(queryString) : url;\n  return request(fullUrl, {\n    method: 'GET'\n  });\n}\n\n/**\r\n * POST请求\r\n */\nexport function post(url) {\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return request(url, {\n    method: 'POST',\n    body: JSON.stringify(data)\n  });\n}\n\n/**\r\n * PUT请求\r\n */\nexport function put(url) {\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return request(url, {\n    method: 'PUT',\n    body: JSON.stringify(data)\n  });\n}\n\n/**\r\n * DELETE请求\r\n */\nexport function del(url) {\n  return request(url, {\n    method: 'DELETE'\n  });\n}\n\n/**\r\n * 文件上传\r\n */\nexport function upload(url, file) {\n  var token = localStorage.getItem('token');\n  var formData = new FormData();\n  formData.append('file', file);\n  return fetch(\"\".concat(BASE_URL).concat(url), {\n    method: 'POST',\n    headers: _objectSpread({}, token && {\n      token: token\n    }),\n    body: formData\n  }).then(/*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee(response) {\n      var result;\n      return _regenerator().w(function (_context) {\n        while (1) switch (_context.n) {\n          case 0:\n            _context.n = 1;\n            return response.json();\n          case 1:\n            result = _context.v;\n            if (!(result.code === 0)) {\n              _context.n = 2;\n              break;\n            }\n            throw new Error(result.msg || '上传失败');\n          case 2:\n            return _context.a(2, result);\n        }\n      }, _callee);\n    }));\n    return function (_x2) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n}\nexport default {\n  get: get,\n  post: post,\n  put: put,\n  \"delete\": del,\n  upload: upload\n};","map":{"version":3,"names":["BASE_URL","request","_x","_request","apply","arguments","_asyncToGenerator","_regenerator","m","_callee2","url","options","token","defaultOptions","config","_result$msg","_result$msg2","response","contentType","result","_args2","_t","w","_context2","p","n","length","undefined","localStorage","getItem","headers","_objectSpread","fetch","concat","v","get","includes","ok","a","code","msg","data","Error","status","json","removeItem","window","location","pathname","href","console","error","params","queryString","URLSearchParams","toString","fullUrl","method","post","body","JSON","stringify","put","del","upload","file","formData","FormData","append","then","_ref","_callee","_context","_x2"],"sources":["D:/883vue1/fronted-merge_fronted/883Fronted_Final/src/utils/request.js"],"sourcesContent":["// API请求工具类\r\nconst BASE_URL = 'http://127.0.0.1:8081'\r\n\r\n/**\r\n * 通用请求方法\r\n * @param {string} url - 请求路径\r\n * @param {object} options - 请求选项\r\n * @returns {Promise} 响应数据\r\n */\r\nasync function request(url, options = {}) {\r\n  const token = localStorage.getItem('token')\r\n  \r\n  const defaultOptions = {\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...(token && { token: token })\r\n    }\r\n  }\r\n\r\n  const config = {\r\n    ...defaultOptions,\r\n    ...options,\r\n    headers: {\r\n      ...defaultOptions.headers,\r\n      ...(options.headers || {})\r\n    }\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(`${BASE_URL}${url}`, config)\r\n    \r\n    // 处理非JSON响应\r\n    const contentType = response.headers.get('content-type')\r\n    if (!contentType || !contentType.includes('application/json')) {\r\n      if (response.ok) {\r\n        return { code: 1, msg: 'success', data: null }\r\n      } else {\r\n        throw new Error(`请求失败: ${response.status}`)\r\n      }\r\n    }\r\n\r\n    const result = await response.json()\r\n\r\n    // 处理token过期或未授权\r\n    if (result.code === 0 && (result.msg?.includes('token') || result.msg?.includes('登录'))) {\r\n      localStorage.removeItem('token')\r\n      localStorage.removeItem('userInfo')\r\n      if (window.location.pathname !== '/login') {\r\n        window.location.href = '/login'\r\n      }\r\n      throw new Error(result.msg || '登录已过期，请重新登录')\r\n    }\r\n\r\n    return result\r\n  } catch (error) {\r\n    console.error('请求错误:', error)\r\n    throw error\r\n  }\r\n}\r\n\r\n/**\r\n * GET请求\r\n */\r\nexport function get(url, params = {}) {\r\n  const queryString = new URLSearchParams(params).toString()\r\n  const fullUrl = queryString ? `${url}?${queryString}` : url\r\n  return request(fullUrl, { method: 'GET' })\r\n}\r\n\r\n/**\r\n * POST请求\r\n */\r\nexport function post(url, data = {}) {\r\n  return request(url, {\r\n    method: 'POST',\r\n    body: JSON.stringify(data)\r\n  })\r\n}\r\n\r\n/**\r\n * PUT请求\r\n */\r\nexport function put(url, data = {}) {\r\n  return request(url, {\r\n    method: 'PUT',\r\n    body: JSON.stringify(data)\r\n  })\r\n}\r\n\r\n/**\r\n * DELETE请求\r\n */\r\nexport function del(url) {\r\n  return request(url, { method: 'DELETE' })\r\n}\r\n\r\n/**\r\n * 文件上传\r\n */\r\nexport function upload(url, file) {\r\n  const token = localStorage.getItem('token')\r\n  const formData = new FormData()\r\n  formData.append('file', file)\r\n\r\n  return fetch(`${BASE_URL}${url}`, {\r\n    method: 'POST',\r\n    headers: {\r\n      ...(token && { token: token })\r\n    },\r\n    body: formData\r\n  }).then(async (response) => {\r\n    const result = await response.json()\r\n    if (result.code === 0) {\r\n      throw new Error(result.msg || '上传失败')\r\n    }\r\n    return result\r\n  })\r\n}\r\n\r\nexport default {\r\n  get,\r\n  post,\r\n  put,\r\n  delete: del,\r\n  upload\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}