{"ast":null,"code":"import _regenerator from \"D:/vvvvvvvvvscode_workspace/fronted/883Fronted_Final/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"D:/vvvvvvvvvscode_workspace/fronted/883Fronted_Final/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.parse-float.js\";\nimport { ref, onMounted, computed } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nexport default {\n  name: 'StuClassResource',\n  setup: function setup() {\n    var route = useRoute();\n    var router = useRouter();\n    var classId = computed(function () {\n      return route.query.classId || localStorage.getItem('currentClassId');\n    });\n\n    // Áä∂ÊÄÅÁÆ°ÁêÜ\n    var currentFolderId = ref(null);\n    var breadcrumbStack = ref([]);\n    var folders = ref([]);\n    var files = ref([]);\n    var loading = ref(false);\n    onMounted(function () {\n      if (classId.value) fetchResources();\n    });\n    var goBackToCourses = function goBackToCourses() {\n      router.push({\n        path: '/student/teachinghome'\n      });\n    };\n    // Ëé∑ÂèñËµÑÊ∫êÂàóË°® (Êé•Âè£ÊñáÊ°£ 5.1)\n    var fetchResources = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n        var url, res, result, _t;\n        return _regenerator().w(function (_context) {\n          while (1) switch (_context.p = _context.n) {\n            case 0:\n              loading.value = true;\n              _context.p = 1;\n              url = \"http://127.0.0.1:8081/classes/\".concat(classId.value, \"/resources\");\n              if (currentFolderId.value) {\n                url += \"?folder_id=\".concat(currentFolderId.value);\n              }\n              _context.n = 2;\n              return fetch(url);\n            case 2:\n              res = _context.v;\n              _context.n = 3;\n              return res.json();\n            case 3:\n              result = _context.v;\n              if (result.code === 1) {\n                folders.value = result.data.folders || [];\n                files.value = result.data.files || [];\n              }\n              _context.n = 5;\n              break;\n            case 4:\n              _context.p = 4;\n              _t = _context.v;\n              console.error(_t);\n            case 5:\n              _context.p = 5;\n              loading.value = false;\n              return _context.f(5);\n            case 6:\n              return _context.a(2);\n          }\n        }, _callee, null, [[1, 4, 5, 6]]);\n      }));\n      return function fetchResources() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    // ËøõÂÖ•Êñá‰ª∂Â§π\n    var enterFolder = function enterFolder(folder) {\n      currentFolderId.value = folder.folder_id;\n      breadcrumbStack.value.push({\n        id: folder.folder_id,\n        name: folder.folder_name\n      });\n      fetchResources();\n    };\n\n    // ÂØºËà™Ë∑≥ËΩ¨ÔºàÈù¢ÂåÖÂ±ëÁÇπÂáªÔºâ\n    var navigateToFolder = function navigateToFolder(folderId, name, index) {\n      currentFolderId.value = folderId;\n      if (folderId === null) {\n        breadcrumbStack.value = [];\n      } else if (index !== undefined) {\n        breadcrumbStack.value = breadcrumbStack.value.slice(0, index + 1);\n      }\n      fetchResources();\n    };\n\n    // ‰∏ãËΩΩÊñá‰ª∂\n    var downloadFile = function downloadFile(file) {\n      if (file.file_url) {\n        window.open(file.file_url, '_blank');\n      } else {\n        alert('Êñá‰ª∂ÈìæÊé•Êó†Êïà');\n      }\n    };\n\n    // Â∑•ÂÖ∑ÂáΩÊï∞\n    var formatSize = function formatSize(bytes) {\n      if (!bytes) return '0 B';\n      var k = 1024;\n      var sizes = ['B', 'KB', 'MB', 'GB'];\n      var i = Math.floor(Math.log(bytes) / Math.log(k));\n      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n    };\n    var formatTime = function formatTime(t) {\n      return new Date(t).toLocaleDateString();\n    };\n    return {\n      router: router,\n      classId: classId,\n      currentFolderId: currentFolderId,\n      breadcrumbStack: breadcrumbStack,\n      folders: folders,\n      files: files,\n      loading: loading,\n      goBackToCourses: goBackToCourses,\n      fetchResources: fetchResources,\n      enterFolder: enterFolder,\n      navigateToFolder: navigateToFolder,\n      downloadFile: downloadFile,\n      formatSize: formatSize,\n      formatTime: formatTime\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","useRoute","useRouter","name","setup","route","router","classId","query","localStorage","getItem","currentFolderId","breadcrumbStack","folders","files","loading","value","fetchResources","goBackToCourses","push","path","_ref","_asyncToGenerator","_regenerator","m","_callee","url","res","result","_t","w","_context","p","n","concat","fetch","v","json","code","data","console","error","f","a","apply","arguments","enterFolder","folder","folder_id","id","folder_name","navigateToFolder","folderId","index","undefined","slice","downloadFile","file","file_url","window","open","alert","formatSize","bytes","k","sizes","i","Math","floor","log","parseFloat","pow","toFixed","formatTime","t","Date","toLocaleDateString"],"sources":["D:\\vvvvvvvvvscode_workspace\\fronted\\883Fronted_Final\\src\\views\\Student\\Teaching\\course\\StuClassResource.vue"],"sourcesContent":["<template>\r\n  <div class=\"resources-page\">\r\n    <div class=\"page-header\">\r\n      <h2>ËØæÁ®ãËµÑÊ∫ê</h2>\r\n      <div class=\"header-actions\">\r\n        <button class=\"back-btn\" @click=\"goBackToCourses\">ËøîÂõûËØæÁ®ãÂàóË°®</button>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"breadcrumb\">\r\n      <span class=\"crumb-item\" :class=\"{ active: currentFolderId === null }\" @click=\"navigateToFolder(null, 'Ê†πÁõÆÂΩï')\">\r\n        üìÅ Ê†πÁõÆÂΩï\r\n      </span>\r\n      <span v-for=\"(folder, index) in breadcrumbStack\" :key=\"folder.id\" class=\"crumb-separator\">\r\n        /\r\n        <span class=\"crumb-item\" :class=\"{ active: index === breadcrumbStack.length - 1 }\"\r\n          @click=\"navigateToFolder(folder.id, folder.name, index)\">\r\n          {{ folder.name }}\r\n        </span>\r\n      </span>\r\n    </div>\r\n\r\n    <div v-if=\"loading\" class=\"loading\">Âä†ËΩΩËµÑÊ∫ê‰∏≠...</div>\r\n\r\n    <div v-else class=\"resource-list\">\r\n      <div v-for=\"folder in folders\" :key=\"folder.folder_id\" class=\"resource-item folder\" @click=\"enterFolder(folder)\">\r\n        <span class=\"icon\">üìÇ</span>\r\n        <div class=\"info\">\r\n          <div class=\"name\">{{ folder.folder_name }}</div>\r\n          <div class=\"meta\">Êñá‰ª∂Â§π</div>\r\n        </div>\r\n        <span class=\"arrow\">‚Ä∫</span>\r\n      </div>\r\n\r\n      <div v-for=\"file in files\" :key=\"file.resource_id\" class=\"resource-item file\" @click=\"downloadFile(file)\">\r\n        <span class=\"icon\">üìÑ</span>\r\n        <div class=\"info\">\r\n          <div class=\"name\">{{ file.file_name }}</div>\r\n          <div class=\"meta\">\r\n            {{ formatSize(file.file_size) }} | {{ formatTime(file.upload_at) }}\r\n          </div>\r\n        </div>\r\n        <span class=\"download-icon\">‚¨áÔ∏è</span>\r\n      </div>\r\n\r\n      <div v-if=\"folders.length === 0 && files.length === 0\" class=\"empty\">\r\n        Ê≠§Êñá‰ª∂Â§π‰∏ãÊöÇÊó†ÂÜÖÂÆπ\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\n\r\nexport default {\r\n  name: 'StuClassResource',\r\n  setup() {\r\n    const route = useRoute()\r\n    const router = useRouter()\r\n    const classId = computed(() => route.query.classId || localStorage.getItem('currentClassId'))\r\n\r\n    // Áä∂ÊÄÅÁÆ°ÁêÜ\r\n    const currentFolderId = ref(null)\r\n    const breadcrumbStack = ref([])\r\n    const folders = ref([])\r\n    const files = ref([])\r\n    const loading = ref(false)\r\n\r\n    onMounted(() => {\r\n      if (classId.value) fetchResources()\r\n    })\r\n    const goBackToCourses = () => {\r\n      router.push({ path: '/student/teachinghome' })\r\n    }\r\n    // Ëé∑ÂèñËµÑÊ∫êÂàóË°® (Êé•Âè£ÊñáÊ°£ 5.1)\r\n    const fetchResources = async () => {\r\n      loading.value = true\r\n      try {\r\n        let url = `http://127.0.0.1:8081/classes/${classId.value}/resources`\r\n        if (currentFolderId.value) {\r\n          url += `?folder_id=${currentFolderId.value}`\r\n        }\r\n\r\n        const res = await fetch(url)\r\n        const result = await res.json()\r\n        if (result.code === 1) {\r\n          folders.value = result.data.folders || []\r\n          files.value = result.data.files || []\r\n        }\r\n      } catch (e) {\r\n        console.error(e)\r\n      } finally {\r\n        loading.value = false\r\n      }\r\n    }\r\n\r\n    // ËøõÂÖ•Êñá‰ª∂Â§π\r\n    const enterFolder = (folder) => {\r\n      currentFolderId.value = folder.folder_id\r\n      breadcrumbStack.value.push({ id: folder.folder_id, name: folder.folder_name })\r\n      fetchResources()\r\n    }\r\n\r\n    // ÂØºËà™Ë∑≥ËΩ¨ÔºàÈù¢ÂåÖÂ±ëÁÇπÂáªÔºâ\r\n    const navigateToFolder = (folderId, name, index) => {\r\n      currentFolderId.value = folderId\r\n      if (folderId === null) {\r\n        breadcrumbStack.value = []\r\n      } else if (index !== undefined) {\r\n        breadcrumbStack.value = breadcrumbStack.value.slice(0, index + 1)\r\n      }\r\n      fetchResources()\r\n    }\r\n\r\n    // ‰∏ãËΩΩÊñá‰ª∂\r\n    const downloadFile = (file) => {\r\n      if (file.file_url) {\r\n        window.open(file.file_url, '_blank')\r\n      } else {\r\n        alert('Êñá‰ª∂ÈìæÊé•Êó†Êïà')\r\n      }\r\n    }\r\n\r\n    // Â∑•ÂÖ∑ÂáΩÊï∞\r\n    const formatSize = (bytes) => {\r\n      if (!bytes) return '0 B'\r\n      const k = 1024\r\n      const sizes = ['B', 'KB', 'MB', 'GB']\r\n      const i = Math.floor(Math.log(bytes) / Math.log(k))\r\n      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\r\n    }\r\n    \r\n    const formatTime = (t) => new Date(t).toLocaleDateString()\r\n\r\n    return {\r\n      router,\r\n      classId,\r\n      currentFolderId,\r\n      breadcrumbStack,\r\n      folders,\r\n      files,\r\n      loading,\r\n      goBackToCourses,\r\n      fetchResources,\r\n      enterFolder,\r\n      navigateToFolder,\r\n      downloadFile,\r\n      formatSize,\r\n      formatTime\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.resources-page {\r\n  padding: 24px;\r\n  max-inline-size: 900px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.page-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-block-end: 20px;\r\n}\r\n\r\n.back-btn {\r\n  padding: 8px 16px;\r\n  border: 1px solid #ddd;\r\n  background: white;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n.breadcrumb {\r\n  background: #f5f7fa;\r\n  padding: 10px 15px;\r\n  border-radius: 6px;\r\n  margin-block-end: 20px;\r\n  color: #666;\r\n  font-size: 14px;\r\n}\r\n\r\n.crumb-item {\r\n  cursor: pointer;\r\n  color: #2A5CAA;\r\n}\r\n\r\n.crumb-item:hover {\r\n  text-decoration: underline;\r\n}\r\n\r\n.crumb-item.active {\r\n  color: #666;\r\n  cursor: default;\r\n  text-decoration: none;\r\n}\r\n\r\n.crumb-separator {\r\n  margin: 0 5px;\r\n  color: #ccc;\r\n}\r\n\r\n.resource-list {\r\n  background: white;\r\n  border: 1px solid #eee;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n}\r\n\r\n.resource-item {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 15px 20px;\r\n  border-block-end: 1px solid #f0f0f0;\r\n  cursor: pointer;\r\n  transition: background 0.2s;\r\n}\r\n\r\n.resource-item:hover {\r\n  background: #f9f9f9;\r\n}\r\n\r\n.resource-item:last-child {\r\n  border-block-end: none;\r\n}\r\n\r\n.icon {\r\n  font-size: 24px;\r\n  margin-inline-end: 15px;\r\n}\r\n\r\n.info {\r\n  flex: 1;\r\n}\r\n\r\n.name {\r\n  font-size: 15px;\r\n  color: #333;\r\n  margin-block-end: 4px;\r\n}\r\n\r\n.meta {\r\n  font-size: 12px;\r\n  color: #999;\r\n}\r\n\r\n.arrow,\r\n.download-icon {\r\n  color: #ccc;\r\n  font-size: 18px;\r\n}\r\n\r\n.download-icon:hover {\r\n  color: #2A5CAA;\r\n}\r\n\r\n.loading,\r\n.empty {\r\n  text-align: center;\r\n  padding: 40px;\r\n  color: #999;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}