{"ast":null,"code":"import _regenerator from \"D:/vvvvvvvvvscode_workspace/fronted/883Fronted_Final/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"D:/vvvvvvvvvscode_workspace/fronted/883Fronted_Final/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.date.to-json.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport { ref, reactive, onMounted, computed } from 'vue';\nimport { useRouter } from 'vue-router';\nvar BAIDU_AK = '3Jbw6qq8jVSn3CzXu0btBU2lpgffWz5G';\nexport default {\n  __name: 'Launch',\n  setup: function setup(__props, _ref) {\n    var __expose = _ref.expose;\n    __expose();\n    var router = useRouter();\n    var showMap = ref(false);\n    var courseName = ref('');\n    var addressName = ref('');\n    var loading = ref(false);\n\n    // ä½ çš„ç™¾åº¦åœ°å›¾ AK\n    var mapUrl = computed(function () {\n      return \"https://api.map.baidu.com/marker?location=39.916979519873,116.41004950566&title=\\u6559\\u5BA4\\u4F4D\\u7F6E&content=\\u8BF7\\u786E\\u8BA4\\u4F4D\\u7F6E&output=html&src=webapp.baidu.openAPIdemo&ak=\".concat(BAIDU_AK);\n    });\n    var formData = reactive({\n      class_id: '',\n      session_type: 1,\n      duration: 10,\n      required_latitude: null,\n      required_longitude: null,\n      required_radius: 100\n    });\n    var hasLocation = computed(function () {\n      return formData.required_latitude && formData.required_longitude;\n    });\n    onMounted(function () {\n      courseName.value = sessionStorage.getItem('selectedCourseName') || 'Modern Cryptography';\n      formData.class_id = sessionStorage.getItem('selectedClassId') || '1';\n    });\n    var openMapModal = function openMapModal() {\n      showMap.value = true;\n    };\n    var confirmLocation = function confirmLocation() {\n      formData.required_latitude = 30.5133;\n      formData.required_longitude = 114.3640;\n      addressName.value = \"å·²é€‰å®šï¼šæ•™å­¦æ¥¼ N201\";\n      showMap.value = false;\n    };\n    var handleSubmit = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n        var _t;\n        return _regenerator().w(function (_context) {\n          while (1) switch (_context.p = _context.n) {\n            case 0:\n              loading.value = true;\n              _context.p = 1;\n              _context.n = 2;\n              return fetch(\"http://127.0.0.1:8081/teacher/classes/\".concat(formData.class_id, \"/attendance/start\"), {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json',\n                  'token': localStorage.getItem('token')\n                },\n                body: JSON.stringify(formData)\n              });\n            case 2:\n              _context.n = 4;\n              break;\n            case 3:\n              _context.p = 3;\n              _t = _context.v;\n              console.warn('åç«¯è¿æ¥å¤±è´¥ï¼Œèµ°æ¼”ç¤ºæ¨¡å¼');\n            case 4:\n              _context.p = 4;\n              loading.value = false;\n              alert(\"\\u7B7E\\u5230\\u5DF2\\u53D1\\u8D77\\uFF01\\n\\u7C7B\\u578B\\uFF1A\".concat(formData.session_type === 1 ? 'æ™®é€š' : 'å®šä½', \"\\n\\u65F6\\u957F\\uFF1A\").concat(formData.duration, \"\\u5206\\u949F\"));\n              router.push('detail');\n              return _context.f(4);\n            case 5:\n              return _context.a(2);\n          }\n        }, _callee, null, [[1, 3, 4, 5]]);\n      }));\n      return function handleSubmit() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    var __returned__ = {\n      router: router,\n      showMap: showMap,\n      courseName: courseName,\n      addressName: addressName,\n      loading: loading,\n      BAIDU_AK: BAIDU_AK,\n      mapUrl: mapUrl,\n      formData: formData,\n      hasLocation: hasLocation,\n      openMapModal: openMapModal,\n      confirmLocation: confirmLocation,\n      handleSubmit: handleSubmit,\n      ref: ref,\n      reactive: reactive,\n      onMounted: onMounted,\n      computed: computed,\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","onMounted","computed","useRouter","BAIDU_AK","router","showMap","courseName","addressName","loading","mapUrl","concat","formData","class_id","session_type","duration","required_latitude","required_longitude","required_radius","hasLocation","value","sessionStorage","getItem","openMapModal","confirmLocation","handleSubmit","_ref2","_asyncToGenerator","_regenerator","m","_callee","_t","w","_context","p","n","fetch","method","headers","localStorage","body","JSON","stringify","v","console","warn","alert","push","f","a","apply","arguments"],"sources":["D:/vvvvvvvvvscode_workspace/fronted/883Fronted_Final/src/views/Teacher/Teaching/course/attendance/Launch.vue"],"sourcesContent":["<template>\r\n  <div class=\"attendance-launch\">\r\n    <div class=\"page-header\">\r\n      <h1>å‘èµ·ç­¾åˆ°</h1>\r\n      <p class=\"page-description\">è®¾ç½®ç­¾åˆ°è§„åˆ™ä¸èŒƒå›´</p>\r\n    </div>\r\n\r\n    <section class=\"card form-card\">\r\n      <form @submit.prevent=\"handleSubmit\" class=\"attendance-form\">\r\n        <div class=\"form-group\">\r\n          <label>å½“å‰è¯¾ç¨‹</label>\r\n          <div class=\"course-badge\">\r\n            <span class=\"course-name\">{{ courseName }}</span>\r\n            <span class=\"course-id\">ID: {{ formData.class_id }}</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label>ç­¾åˆ°ç±»å‹</label>\r\n          <div class=\"type-selector\">\r\n            <div\r\n                class=\"type-card\"\r\n                :class=\"{ active: formData.session_type === 1 }\"\r\n                @click=\"formData.session_type = 1\"\r\n            >\r\n              <i class=\"bi bi-person-bounding-box\"></i> æ™®é€šç­¾åˆ°\r\n            </div>\r\n            <div\r\n                class=\"type-card\"\r\n                :class=\"{ active: formData.session_type === 2 }\"\r\n                @click=\"formData.session_type = 2\"\r\n            >\r\n              <i class=\"bi bi-geo-alt-fill\"></i> ä½ç½®ç­¾åˆ°\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label>ç­¾åˆ°æ—¶é•¿</label>\r\n          <div class=\"duration-options\">\r\n            <span v-for=\"t in [5, 10, 15, 30]\" :key=\"t\"\r\n                  class=\"tag\" :class=\"{ active: formData.duration === t }\"\r\n                  @click=\"formData.duration = t\">{{ t }}åˆ†é’Ÿ</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div v-if=\"formData.session_type === 2\" class=\"location-box\">\r\n          <label class=\"section-label\">ğŸ“ è€ƒå‹¤ä½ç½®è®¾ç½®</label>\r\n\r\n          <div class=\"map-preview\" v-if=\"!hasLocation\">\r\n            <button type=\"button\" class=\"btn-map\" @click=\"openMapModal\">\r\n              <i class=\"bi bi-map\"></i> æ‰“å¼€åœ°å›¾é€‰æ‹©ä½ç½®\r\n            </button>\r\n            <p class=\"hint\">ç‚¹å‡»æŒ‰é’®ï¼Œåœ¨åœ°å›¾ä¸Šç‚¹é€‰æ•™å®¤ä½ç½®</p>\r\n          </div>\r\n\r\n          <div class=\"location-result\" v-else>\r\n            <div class=\"coord-info\">\r\n              <div class=\"res-item\"><strong>çº¬åº¦ï¼š</strong>{{ formData.required_latitude }}</div>\r\n              <div class=\"res-item\"><strong>ç»åº¦ï¼š</strong>{{ formData.required_longitude }}</div>\r\n              <div class=\"res-item address\"><strong>åœ°å€ï¼š</strong>{{ addressName }}</div>\r\n            </div>\r\n            <button type=\"button\" class=\"btn-reselect\" @click=\"openMapModal\">é‡æ–°é€‰æ‹©</button>\r\n          </div>\r\n\r\n          <div class=\"radius-setting\">\r\n            <label>å…è®¸åŠå¾„: {{ formData.required_radius }} ç±³</label>\r\n            <input type=\"range\" v-model=\"formData.required_radius\" min=\"50\" max=\"500\" step=\"50\">\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-actions\">\r\n          <button type=\"button\" class=\"button-submit\" @click=\"handleSubmit\" :disabled=\"loading\">\r\n            {{ loading ? 'å‘èµ·ä¸­...' : 'ç«‹å³å‘èµ·' }}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </section>\r\n\r\n    <div v-if=\"showMap\" class=\"map-modal-overlay\">\r\n      <div class=\"map-modal\">\r\n        <div class=\"map-header\">\r\n          <h3>è¯·åœ¨åœ°å›¾ä¸Šç‚¹å‡»é€‰æ‹©ä½ç½®</h3>\r\n          <span class=\"close\" @click=\"showMap = false\">Ã—</span>\r\n        </div>\r\n        <div class=\"map-body\">\r\n          <iframe\r\n              id=\"mapPage\"\r\n              width=\"100%\"\r\n              height=\"100%\"\r\n              frameborder=\"0\"\r\n              :src=\"mapUrl\"\r\n          ></iframe>\r\n        </div>\r\n        <div class=\"map-footer\">\r\n          <p class=\"tip\">æç¤ºï¼šåœ¨åœ°å›¾ä¸Šæ‰¾åˆ°æ•™å®¤ä½ç½®åï¼Œç‚¹å‡»ä¸‹æ–¹ç¡®è®¤ (æ¼”ç¤ºæ¨¡å¼)</p>\r\n          <button class=\"button-confirm\" @click=\"confirmLocation\">æˆ‘å·²é€‰å¥½ä½ç½® (ç¡®è®¤)</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, computed } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\n\r\nconst router = useRouter()\r\nconst showMap = ref(false)\r\nconst courseName = ref('')\r\nconst addressName = ref('')\r\nconst loading = ref(false)\r\n\r\n// ä½ çš„ç™¾åº¦åœ°å›¾ AK\r\nconst BAIDU_AK = '3Jbw6qq8jVSn3CzXu0btBU2lpgffWz5G'\r\n\r\nconst mapUrl = computed(() => {\r\n  return `https://api.map.baidu.com/marker?location=39.916979519873,116.41004950566&title=æ•™å®¤ä½ç½®&content=è¯·ç¡®è®¤ä½ç½®&output=html&src=webapp.baidu.openAPIdemo&ak=${BAIDU_AK}`\r\n})\r\n\r\nconst formData = reactive({\r\n  class_id: '',\r\n  session_type: 1,\r\n  duration: 10,\r\n  required_latitude: null,\r\n  required_longitude: null,\r\n  required_radius: 100\r\n})\r\n\r\nconst hasLocation = computed(() => formData.required_latitude && formData.required_longitude)\r\n\r\nonMounted(() => {\r\n  courseName.value = sessionStorage.getItem('selectedCourseName') || 'Modern Cryptography'\r\n  formData.class_id = sessionStorage.getItem('selectedClassId') || '1'\r\n})\r\n\r\nconst openMapModal = () => {\r\n  showMap.value = true\r\n}\r\n\r\nconst confirmLocation = () => {\r\n  formData.required_latitude = 30.5133\r\n  formData.required_longitude = 114.3640\r\n  addressName.value = \"å·²é€‰å®šï¼šæ•™å­¦æ¥¼ N201\"\r\n  showMap.value = false\r\n}\r\n\r\nconst handleSubmit = async () => {\r\n  loading.value = true\r\n  try {\r\n    // å°è¯•çœŸå®è¯·æ±‚\r\n    await fetch(`http://127.0.0.1:8081/teacher/classes/${formData.class_id}/attendance/start`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json', 'token': localStorage.getItem('token') },\r\n      body: JSON.stringify(formData)\r\n    })\r\n  } catch (e) {\r\n    console.warn('åç«¯è¿æ¥å¤±è´¥ï¼Œèµ°æ¼”ç¤ºæ¨¡å¼')\r\n  } finally {\r\n    loading.value = false\r\n    alert(`ç­¾åˆ°å·²å‘èµ·ï¼\\nç±»å‹ï¼š${formData.session_type === 1 ? 'æ™®é€š' : 'å®šä½'}\\næ—¶é•¿ï¼š${formData.duration}åˆ†é’Ÿ`)\r\n    router.push('detail')\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* æ ·å¼ä¿æŒä¸å˜ï¼Œç›´æ¥å¤ç”¨ä¸Šä¸€æ¬¡çš„ */\r\n.attendance-launch { padding: 24px; max-width: 800px; margin: 0 auto; }\r\n.page-header h1 { color: #333; margin-bottom: 5px; }\r\n.form-card { background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }\r\n.form-group { margin-bottom: 25px; }\r\n.form-group label { display: block; font-weight: 600; margin-bottom: 10px; color: #444; }\r\n.course-badge { background: #f0f7ff; border: 1px solid #2A5CAA; border-radius: 8px; padding: 12px; display: flex; justify-content: space-between; align-items: center; color: #2A5CAA; }\r\n.course-name { font-weight: bold; font-size: 16px; }\r\n.course-id { font-size: 13px; opacity: 0.8; }\r\n.type-selector { display: flex; gap: 20px; }\r\n.type-card { flex: 1; border: 2px solid #eee; padding: 20px; border-radius: 10px; text-align: center; cursor: pointer; transition: all 0.3s; }\r\n.type-card:hover { border-color: #b3c7f9; }\r\n.type-card.active { border-color: #2A5CAA; background: #eef2ff; color: #2A5CAA; font-weight: bold; }\r\n.type-card i { font-size: 24px; display: block; margin-bottom: 8px; }\r\n.duration-options { display: flex; gap: 10px; }\r\n.tag { padding: 8px 16px; background: #f5f5f5; border-radius: 20px; cursor: pointer; transition: all 0.2s; }\r\n.tag.active { background: #2A5CAA; color: white; }\r\n.location-box { background: #f9fafb; padding: 20px; border-radius: 8px; border: 1px dashed #ccc; }\r\n.btn-map { width: 100%; padding: 15px; background: white; border: 1px solid #2A5CAA; color: #2A5CAA; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px; }\r\n.location-result { display: flex; justify-content: space-between; align-items: center; background: white; padding: 15px; border-radius: 8px; }\r\n.res-item { font-size: 13px; color: #555; margin-bottom: 4px; }\r\n.btn-reselect { background: none; border: none; color: #2A5CAA; cursor: pointer; text-decoration: underline; }\r\n.button-submit { width: 100%; padding: 14px; background: #2A5CAA; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; margin-top: 20px; }\r\n.button-submit:hover:not(:disabled) { background: #1e4b8b; }\r\n.button-submit:disabled { background: #ccc; }\r\n.map-modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: flex; align-items: center; justify-content: center; z-index: 1000; }\r\n.map-modal { background: white; width: 90%; max-width: 700px; height: 80vh; border-radius: 12px; display: flex; flex-direction: column; overflow: hidden; }\r\n.map-header { padding: 15px; display: flex; justify-content: space-between; border-bottom: 1px solid #eee; background: #f5f5f5; }\r\n.map-header .close { font-size: 24px; cursor: pointer; }\r\n.map-body { flex: 1; position: relative; }\r\n.map-footer { padding: 15px; text-align: center; background: #fff; border-top: 1px solid #eee; }\r\n.button-confirm { background: #2A5CAA; color: white; border: none; padding: 10px 40px; border-radius: 20px; cursor: pointer; font-weight: bold; }\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}