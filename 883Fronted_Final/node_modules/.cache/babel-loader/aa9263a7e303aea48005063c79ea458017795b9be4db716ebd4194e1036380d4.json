{"ast":null,"code":"import _regenerator from \"D:/883vue1/fronted-merge_fronted/883Fronted_Final/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"D:/883vue1/fronted-merge_fronted/883Fronted_Final/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.some.js\";\nimport \"core-js/modules/es.date.to-json.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport { ref, reactive } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { login } from '@/api/user';\nexport default {\n  name: 'Login',\n  setup: function setup() {\n    var router = useRouter();\n    var loading = ref(false);\n\n    // ÁôªÂΩïË°®ÂçïÊï∞ÊçÆ\n    var loginForm = reactive({\n      username: '',\n      password: '',\n      rememberMe: false\n    });\n\n    // ÁôªÂΩïÂ§ÑÁêÜÈÄªËæë\n    var handleLogin = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n        var result, _result$data, token, user_id, username, full_name, roles, roleKeys, redirectPath, _t;\n        return _regenerator().w(function (_context) {\n          while (1) switch (_context.p = _context.n) {\n            case 0:\n              if (!(!loginForm.username || !loginForm.password)) {\n                _context.n = 1;\n                break;\n              }\n              alert('ËØ∑ËæìÂÖ•Áî®Êà∑ÂêçÂíåÂØÜÁ†Å');\n              return _context.a(2);\n            case 1:\n              loading.value = true;\n              _context.p = 2;\n              _context.n = 3;\n              return login({\n                username: loginForm.username,\n                password: loginForm.password\n              });\n            case 3:\n              result = _context.v;\n              if (result.code === 1 && result.data) {\n                _result$data = result.data, token = _result$data.token, user_id = _result$data.user_id, username = _result$data.username, full_name = _result$data.full_name, roles = _result$data.roles; // ‰øùÂ≠òtokenÂíåÁî®Êà∑‰ø°ÊÅØ\n                localStorage.setItem('token', token);\n                localStorage.setItem('userInfo', JSON.stringify({\n                  user_id: user_id,\n                  username: username,\n                  full_name: full_name,\n                  roles: roles,\n                  token: token\n                }));\n\n                // Ê†πÊçÆrolesÂà§Êñ≠ËßíËâ≤Âπ∂Ë∑≥ËΩ¨\n                // rolesÊòØÊï∞ÁªÑÔºåÂ¶Ç: ['student'], ['teacher'], ['admin'] Êàñ ['teacher', 'resource_admin']\n                roleKeys = roles || [];\n                redirectPath = '/student/home'; // ÈªòËÆ§Ë∑≥ËΩ¨Âà∞Â≠¶ÁîüÈ¶ñÈ°µ\n                // Ê£ÄÊü•ÊòØÂê¶ÊúâadminËßíËâ≤ÔºàÁÆ°ÁêÜÂëòÔºâ\n                if (roleKeys.includes('admin') || roleKeys.some(function (r) {\n                  return r.includes('admin');\n                })) {\n                  redirectPath = '/admin/home';\n                }\n                // Ê£ÄÊü•ÊòØÂê¶ÊúâteacherËßíËâ≤ÔºàÊïôÂ∏àÔºâ\n                else if (roleKeys.includes('teacher')) {\n                  redirectPath = '/teacher/home';\n                }\n                // ÈªòËÆ§‰∏∫Â≠¶Áîü\n                else {\n                  redirectPath = '/student/home';\n                }\n                router.push(redirectPath);\n              } else {\n                alert(result.msg || 'ÁôªÂΩïÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•Áî®Êà∑ÂêçÂíåÂØÜÁ†Å');\n              }\n              _context.n = 5;\n              break;\n            case 4:\n              _context.p = 4;\n              _t = _context.v;\n              console.error('ÁôªÂΩïÈîôËØØ:', _t);\n              alert(_t.message || 'ÁôªÂΩïÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï');\n            case 5:\n              _context.p = 5;\n              loading.value = false;\n              return _context.f(5);\n            case 6:\n              return _context.a(2);\n          }\n        }, _callee, null, [[2, 4, 5, 6]]);\n      }));\n      return function handleLogin() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    var handleForgotPassword = function handleForgotPassword() {\n      alert('ËØ∑ËÅîÁ≥ªÁÆ°ÁêÜÂëòÈáçÁΩÆÂØÜÁ†Å');\n    };\n    return {\n      loginForm: loginForm,\n      loading: loading,\n      handleLogin: handleLogin,\n      handleForgotPassword: handleForgotPassword\n    };\n  }\n};","map":{"version":3,"names":["ref","reactive","useRouter","login","name","setup","router","loading","loginForm","username","password","rememberMe","handleLogin","_ref","_asyncToGenerator","_regenerator","m","_callee","result","_result$data","token","user_id","full_name","roles","roleKeys","redirectPath","_t","w","_context","p","n","alert","a","value","v","code","data","localStorage","setItem","JSON","stringify","includes","some","r","push","msg","console","error","message","f","apply","arguments","handleForgotPassword"],"sources":["D:\\883vue1\\fronted-merge_fronted\\883Fronted_Final\\src\\views\\Login.vue"],"sourcesContent":["<template>\n    <div class=\"login-container\">\n        <div class=\"login-content\">\n            <div class=\"login-left\">\n                <div class=\"campus-image\">\n                    <img src=\"@/assets/images/login_left_image.jpg\" alt=\"Ê†°Âõ≠ÂõæÁâá\" class=\"cover-img\">\n                </div>\n            </div>\n\n            <div class=\"login-right\">\n                <div class=\"login-form-wrapper\">\n                    <div class=\"login-header\">\n                        <h1>Ê¨¢ËøéÁôªÂΩï Êô∫ÊÖßÊ†°Âõ≠</h1>\n                        <p>Smart Campus Management System</p>\n                    </div>\n\n                    <form @submit.prevent=\"handleLogin\">\n                        <div class=\"form-group\">\n                            <label for=\"username\">Â≠¶Âè∑/Â∑•Âè∑</label>\n                            <input type=\"text\" id=\"username\" v-model=\"loginForm.username\" placeholder=\"ËØ∑ËæìÂÖ•Â≠¶Âè∑ÊàñÂ∑•Âè∑\"\n                                class=\"form-input\" required>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label for=\"password\">ÂØÜÁ†Å</label>\n                            <input type=\"password\" id=\"password\" v-model=\"loginForm.password\" placeholder=\"ËØ∑ËæìÂÖ•ÂØÜÁ†Å\"\n                                class=\"form-input\" required>\n                        </div>\n\n                        <div class=\"form-options\">\n                            <label class=\"checkbox-label\">\n                                <input type=\"checkbox\" v-model=\"loginForm.rememberMe\">\n                                ËÆ∞‰ΩèÊàë\n                            </label>\n                            <a href=\"#\" class=\"forgot-password\" @click.prevent=\"handleForgotPassword\">ÂøòËÆ∞ÂØÜÁ†ÅÔºü</a>\n                        </div>\n\n                        <button type=\"submit\" class=\"login-btn\" :disabled=\"loading\">\n                            {{ loading ? 'ÁôªÂΩï‰∏≠...' : 'ÁôªÂΩï' }}\n                        </button>\n                    </form>\n\n                    <div class=\"account-help\">\n                        <p>üìã <strong>Ë¥¶Âè∑ËØ¥Êòé</strong></p>\n                        <p>‚Ä¢ Â≠¶ÁîüË¥¶Âè∑ÔºöÂ≠¶Âè∑ÔºàÂ¶ÇÔºö2021001001Ôºâ</p>\n                        <p>‚Ä¢ ÊïôÂ∏àË¥¶Âè∑ÔºöÂ∑•Âè∑Ôºà‰ª•TÂºÄÂ§¥ÔºåÂ¶ÇÔºöT2025001Ôºâ</p>\n                        <p>‚Ä¢ ÁÆ°ÁêÜÂëòË¥¶Âè∑Ôºöadmin</p>\n                        <p>‚Ä¢ ÂàùÂßãÂØÜÁ†ÅÔºö123456</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { ref, reactive } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { login } from '@/api/user'\n\nexport default {\n    name: 'Login',\n    setup() {\n        const router = useRouter()\n        const loading = ref(false)\n\n        // ÁôªÂΩïË°®ÂçïÊï∞ÊçÆ\n        const loginForm = reactive({\n            username: '',\n            password: '',\n            rememberMe: false\n        })\n\n        // ÁôªÂΩïÂ§ÑÁêÜÈÄªËæë\n        const handleLogin = async () => {\n            if (!loginForm.username || !loginForm.password) {\n                alert('ËØ∑ËæìÂÖ•Áî®Êà∑ÂêçÂíåÂØÜÁ†Å')\n                return\n            }\n\n            loading.value = true\n\n            try {\n                // Ë∞ÉÁî®ÁôªÂΩïAPI\n                const result = await login({\n                    username: loginForm.username,\n                    password: loginForm.password\n                })\n\n                if (result.code === 1 && result.data) {\n                    const { token, user_id, username, full_name, roles } = result.data\n\n                    // ‰øùÂ≠òtokenÂíåÁî®Êà∑‰ø°ÊÅØ\n                    localStorage.setItem('token', token)\n                    localStorage.setItem('userInfo', JSON.stringify({\n                        user_id,\n                        username,\n                        full_name,\n                        roles,\n                        token\n                    }))\n\n                    // Ê†πÊçÆrolesÂà§Êñ≠ËßíËâ≤Âπ∂Ë∑≥ËΩ¨\n                    // rolesÊòØÊï∞ÁªÑÔºåÂ¶Ç: ['student'], ['teacher'], ['admin'] Êàñ ['teacher', 'resource_admin']\n                    const roleKeys = roles || []\n                    let redirectPath = '/student/home' // ÈªòËÆ§Ë∑≥ËΩ¨Âà∞Â≠¶ÁîüÈ¶ñÈ°µ\n\n                    // Ê£ÄÊü•ÊòØÂê¶ÊúâadminËßíËâ≤ÔºàÁÆ°ÁêÜÂëòÔºâ\n                    if (roleKeys.includes('admin') || roleKeys.some(r => r.includes('admin'))) {\n                        redirectPath = '/admin/home'\n                    } \n                    // Ê£ÄÊü•ÊòØÂê¶ÊúâteacherËßíËâ≤ÔºàÊïôÂ∏àÔºâ\n                    else if (roleKeys.includes('teacher')) {\n                        redirectPath = '/teacher/home'\n                    }\n                    // ÈªòËÆ§‰∏∫Â≠¶Áîü\n                    else {\n                        redirectPath = '/student/home'\n                    }\n\n                    router.push(redirectPath)\n                } else {\n                    alert(result.msg || 'ÁôªÂΩïÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•Áî®Êà∑ÂêçÂíåÂØÜÁ†Å')\n                }\n            } catch (error) {\n                console.error('ÁôªÂΩïÈîôËØØ:', error)\n                alert(error.message || 'ÁôªÂΩïÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï')\n            } finally {\n                loading.value = false\n            }\n        }\n\n        const handleForgotPassword = () => {\n            alert('ËØ∑ËÅîÁ≥ªÁÆ°ÁêÜÂëòÈáçÁΩÆÂØÜÁ†Å')\n        }\n\n        return {\n            loginForm,\n            loading,\n            handleLogin,\n            handleForgotPassword\n        }\n    }\n}\n</script>\n\n<style scoped>\n.login-container {\n    min-block-size: 100vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: #f0f2f5;\n}\n\n.login-content {\n    display: flex;\n    inline-size: 85%;\n    max-inline-size: 1000px;\n    block-size: 600px;\n    background: white;\n    border-radius: 16px;\n    overflow: hidden;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);\n}\n\n/* Â∑¶‰æßÂõæÁâáÂå∫ */\n.login-left {\n    flex: 1.2;\n    background: #f8f9fa;\n    position: relative;\n    overflow: hidden;\n}\n\n.campus-image {\n    inline-size: 100%;\n    block-size: 100%;\n}\n\n.cover-img {\n    inline-size: 100%;\n    block-size: 100%;\n    object-fit: cover;\n    display: block;\n}\n\n/* Âè≥‰æßË°®ÂçïÂå∫ */\n.login-right {\n    flex: 1;\n    padding: 40px;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    background: white;\n}\n\n.login-form-wrapper {\n    inline-size: 100%;\n    max-inline-size: 360px;\n    margin: 0 auto;\n}\n\n.login-header {\n    text-align: center;\n    margin-block-end: 30px;\n}\n\n.login-header h1 {\n    color: #2c3e50;\n    font-size: 26px;\n    font-weight: 600;\n    margin-block-end: 8px;\n}\n\n.login-header p {\n    color: #7f8c8d;\n    font-size: 14px;\n}\n\n.form-group {\n    margin-block-end: 20px;\n}\n\n.form-group label {\n    display: block;\n    margin-block-end: 8px;\n    font-weight: 500;\n    color: #2d3748;\n    font-size: 14px;\n}\n\n.form-input {\n    inline-size: 100%;\n    padding: 12px 16px;\n    border: 1px solid #e2e8f0;\n    border-radius: 8px;\n    font-size: 14px;\n    transition: all 0.3s ease;\n    background: #fafafa;\n    box-sizing: border-box;\n}\n\n.form-input:focus {\n    outline: none;\n    border-color: #2A5CAA;\n    box-shadow: 0 0 0 3px rgba(42, 92, 170, 0.1);\n    background: #fff;\n}\n\n.form-options {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-block-end: 25px;\n    font-size: 14px;\n}\n\n.checkbox-label {\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n    color: #5a6c7d;\n}\n\n.checkbox-label input {\n    margin-inline-end: 8px;\n}\n\n.forgot-password {\n    color: #2A5CAA;\n    text-decoration: none;\n    transition: color 0.2s;\n}\n\n.forgot-password:hover {\n    color: #1e4b8b;\n    text-decoration: underline;\n}\n\n.login-btn {\n    inline-size: 100%;\n    padding: 12px;\n    background: #2A5CAA;\n    color: white;\n    border: none;\n    border-radius: 8px;\n    font-size: 16px;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    margin-block-end: 20px;\n}\n\n.login-btn:hover {\n    background: #1e4b8b;\n    transform: translateY(-1px);\n    box-shadow: 0 4px 12px rgba(42, 92, 170, 0.3);\n}\n\n.login-btn:disabled {\n    background: #a0aec0;\n    cursor: not-allowed;\n}\n\n/* Ë¥¶Âè∑ËØ¥ÊòéÂå∫Âüü */\n.account-help {\n    font-size: 12px;\n    color: #7f8c8d;\n    margin-block-start: 20px;\n    line-height: 1.6;\n    padding: 15px;\n    background-color: #f8f9fa;\n    border-radius: 8px;\n    border: 1px solid #eee;\n}\n\n.account-help p {\n    margin: 4px 0;\n}\n\n.account-help strong {\n    color: #2c3e50;\n}\n\n/* ÂìçÂ∫îÂºèËÆæËÆ° */\n@media (max-width: 768px) {\n    .login-content {\n        flex-direction: column;\n        block-size: auto;\n        inline-size: 90%;\n        margin: 20px 0;\n    }\n\n    .login-left {\n        block-size: 200px;\n        flex: none;\n    }\n\n    .login-right {\n        padding: 30px 20px;\n    }\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}