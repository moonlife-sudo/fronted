{"ast":null,"code":"import _toConsumableArray from \"D:/vvvvvvvvvscode_workspace/fronted/883Fronted_Final/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, withModifiers as _withModifiers } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"grades-composition\"\n};\nvar _hoisted_2 = {\n  \"class\": \"card filter-card\"\n};\nvar _hoisted_3 = {\n  \"class\": \"filter-form\"\n};\nvar _hoisted_4 = {\n  \"class\": \"form-row\"\n};\nvar _hoisted_5 = {\n  \"class\": \"form-group\"\n};\nvar _hoisted_6 = {\n  \"class\": \"form-actions-inline\"\n};\nvar _hoisted_7 = [\"disabled\"];\nvar _hoisted_8 = {\n  key: 0\n};\nvar _hoisted_9 = {\n  key: 1\n};\nvar _hoisted_10 = {\n  key: 0,\n  \"class\": \"card components-card\"\n};\nvar _hoisted_11 = {\n  \"class\": \"components-table-wrapper\"\n};\nvar _hoisted_12 = {\n  \"class\": \"components-table\"\n};\nvar _hoisted_13 = [\"onClick\"];\nvar _hoisted_14 = [\"onClick\"];\nvar _hoisted_15 = {\n  \"class\": \"modal-header\"\n};\nvar _hoisted_16 = {\n  \"class\": \"form-group\"\n};\nvar _hoisted_17 = {\n  key: 0,\n  \"class\": \"form-error\"\n};\nvar _hoisted_18 = {\n  \"class\": \"form-group\"\n};\nvar _hoisted_19 = {\n  key: 0,\n  \"class\": \"form-error\"\n};\nvar _hoisted_20 = {\n  \"class\": \"form-group\"\n};\nvar _hoisted_21 = {\n  key: 0,\n  \"class\": \"form-error\"\n};\nvar _hoisted_22 = {\n  \"class\": \"modal-actions\"\n};\nvar _hoisted_23 = [\"disabled\"];\nvar _hoisted_24 = {\n  key: 0\n};\nvar _hoisted_25 = {\n  key: 1\n};\nvar _hoisted_26 = {\n  key: 2,\n  \"class\": \"card empty-card\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[13] || (_cache[13] = _createElementVNode(\"div\", {\n    \"class\": \"page-header\"\n  }, [_createElementVNode(\"h1\", null, \"管理成绩组成\"), _createElementVNode(\"p\", {\n    \"class\": \"page-description\"\n  }, \"设置班级成绩组成项及其权重\")], -1 /* CACHED */)), _createCommentVNode(\" 查询区域 \"), _createElementVNode(\"section\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n    \"for\": \"class_id\",\n    \"class\": \"form-label required\"\n  }, \"班级ID\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    id: \"class_id\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return $setup.queryForm.class_id = $event;\n    }),\n    type: \"text\",\n    placeholder: \"请输入班级ID\",\n    \"class\": \"input\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.queryForm.class_id]])]), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"button\", {\n    type: \"button\",\n    \"class\": \"button\",\n    onClick: $setup.loadComponents,\n    disabled: $setup.loading\n  }, [$setup.loading ? (_openBlock(), _createElementBlock(\"span\", _hoisted_8, \"查询中...\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_9, \"查询\"))], 8 /* PROPS */, _hoisted_7), _createElementVNode(\"button\", {\n    type: \"button\",\n    \"class\": \"button\",\n    onClick: _cache[1] || (_cache[1] = function ($event) {\n      return $setup.showAddModal = true;\n    })\n  }, \"添加成绩项\")])])])]), _createCommentVNode(\" 成绩组成列表 \"), $setup.components.length > 0 ? (_openBlock(), _createElementBlock(\"section\", _hoisted_10, [_cache[8] || (_cache[8] = _createElementVNode(\"header\", {\n    \"class\": \"card-header\"\n  }, [_createElementVNode(\"h3\", null, \"成绩组成列表\")], -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"table\", _hoisted_12, [_cache[7] || (_cache[7] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", null, \"成绩项ID\"), _createElementVNode(\"th\", null, \"成绩项名称\"), _createElementVNode(\"th\", null, \"权重\"), _createElementVNode(\"th\", null, \"满分\"), _createElementVNode(\"th\", null, \"操作\")])], -1 /* CACHED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.components, function (component) {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: component.component_id\n    }, [_createElementVNode(\"td\", null, _toDisplayString(component.component_id), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(component.component_name), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString((component.weight * 100).toFixed(1)) + \"%\", 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(component.max_score), 1 /* TEXT */), _createElementVNode(\"td\", null, [_createElementVNode(\"button\", {\n      type: \"button\",\n      \"class\": \"button button--outline button--small\",\n      onClick: function onClick($event) {\n        return $setup.editComponent(component);\n      }\n    }, \"修改\", 8 /* PROPS */, _hoisted_13), _createElementVNode(\"button\", {\n      type: \"button\",\n      \"class\": \"button button--outline button--small\",\n      style: {\n        \"margin-inline-start\": \"8px\"\n      },\n      onClick: function onClick($event) {\n        return $setup.deleteComponent(component.component_id);\n      }\n    }, \" 删除 \", 8 /* PROPS */, _hoisted_14)])]);\n  }), 128 /* KEYED_FRAGMENT */))])])])])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 添加/修改模态框 \"), $setup.showAddModal || $setup.showEditModal ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 1,\n    \"class\": \"modal-overlay\",\n    onClick: $setup.closeModal\n  }, [_createElementVNode(\"div\", {\n    \"class\": \"modal-content\",\n    onClick: _cache[5] || (_cache[5] = _withModifiers(function () {}, [\"stop\"]))\n  }, [_createElementVNode(\"div\", _hoisted_15, [_createElementVNode(\"h3\", null, _toDisplayString($setup.showEditModal ? '修改成绩组成' : '添加成绩组成'), 1 /* TEXT */), _createElementVNode(\"button\", {\n    \"class\": \"modal-close\",\n    onClick: $setup.closeModal\n  }, \"×\")]), _createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.handleSubmit, [\"prevent\"]),\n    \"class\": \"modal-form\"\n  }, [_createElementVNode(\"div\", _hoisted_16, [_cache[9] || (_cache[9] = _createElementVNode(\"label\", {\n    \"for\": \"component_name\",\n    \"class\": \"form-label required\"\n  }, \"成绩项名称\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    id: \"component_name\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n      return $setup.formData.component_name = $event;\n    }),\n    type: \"text\",\n    placeholder: \"如：平时作业\",\n    \"class\": _normalizeClass([\"input\", {\n      'input--error': $setup.errors.component_name\n    }])\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.formData.component_name]]), $setup.errors.component_name ? (_openBlock(), _createElementBlock(\"p\", _hoisted_17, _toDisplayString($setup.errors.component_name), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_18, [_cache[10] || (_cache[10] = _createElementVNode(\"label\", {\n    \"for\": \"weight\",\n    \"class\": \"form-label required\"\n  }, \"权重\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    id: \"weight\",\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = function ($event) {\n      return $setup.formData.weight = $event;\n    }),\n    type: \"number\",\n    placeholder: \"如：0.3（表示30%）\",\n    \"class\": _normalizeClass([\"input\", {\n      'input--error': $setup.errors.weight\n    }]),\n    min: \"0\",\n    max: \"1\",\n    step: \"0.01\"\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.formData.weight, void 0, {\n    number: true\n  }]]), $setup.errors.weight ? (_openBlock(), _createElementBlock(\"p\", _hoisted_19, _toDisplayString($setup.errors.weight), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_20, [_cache[11] || (_cache[11] = _createElementVNode(\"label\", {\n    \"for\": \"max_score\",\n    \"class\": \"form-label required\"\n  }, \"满分\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    id: \"max_score\",\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = function ($event) {\n      return $setup.formData.max_score = $event;\n    }),\n    type: \"number\",\n    placeholder: \"如：100\",\n    \"class\": _normalizeClass([\"input\", {\n      'input--error': $setup.errors.max_score\n    }]),\n    min: \"0\",\n    step: \"0.01\"\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.formData.max_score, void 0, {\n    number: true\n  }]]), $setup.errors.max_score ? (_openBlock(), _createElementBlock(\"p\", _hoisted_21, _toDisplayString($setup.errors.max_score), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_22, [_createElementVNode(\"button\", {\n    type: \"button\",\n    \"class\": \"button button--secondary\",\n    onClick: $setup.closeModal\n  }, \"取消\"), _createElementVNode(\"button\", {\n    type: \"submit\",\n    \"class\": \"button\",\n    disabled: $setup.submitting\n  }, [$setup.submitting ? (_openBlock(), _createElementBlock(\"span\", _hoisted_24, \"保存中...\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_25, \"保存\"))], 8 /* PROPS */, _hoisted_23)])], 32 /* NEED_HYDRATION */)])])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 空状态 \"), !$setup.loading && $setup.components.length === 0 && $setup.queryForm.class_id ? (_openBlock(), _createElementBlock(\"section\", _hoisted_26, _toConsumableArray(_cache[12] || (_cache[12] = [_createElementVNode(\"div\", {\n    \"class\": \"empty-state\"\n  }, [_createElementVNode(\"p\", null, \"暂无成绩组成项，请添加\")], -1 /* CACHED */)])))) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["_createElementBlock","_hoisted_1","_createElementVNode","_createCommentVNode","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","id","$setup","queryForm","class_id","$event","type","placeholder","_hoisted_6","onClick","loadComponents","disabled","loading","_hoisted_8","_hoisted_9","_cache","showAddModal","components","length","_hoisted_10","_hoisted_11","_hoisted_12","_Fragment","_renderList","component","key","component_id","_toDisplayString","component_name","weight","toFixed","max_score","editComponent","_hoisted_13","style","deleteComponent","_hoisted_14","showEditModal","closeModal","_withModifiers","_hoisted_15","onSubmit","handleSubmit","_hoisted_16","formData","_normalizeClass","errors","_hoisted_17","_hoisted_18","min","max","step","number","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","submitting","_hoisted_24","_hoisted_25","_hoisted_26","_toConsumableArray"],"sources":["D:\\vvvvvvvvvscode_workspace\\fronted\\883Fronted_Final\\src\\views\\Teacher\\Teaching\\course\\grades\\Composition.vue"],"sourcesContent":["<!-- src/views/teaching/grades/Composition.vue -->\r\n<template>\r\n  <div class=\"grades-composition\">\r\n    <div class=\"page-header\">\r\n      <h1>管理成绩组成</h1>\r\n      <p class=\"page-description\">设置班级成绩组成项及其权重</p>\r\n    </div>\r\n\r\n    <!-- 查询区域 -->\r\n    <section class=\"card filter-card\">\r\n      <div class=\"filter-form\">\r\n        <div class=\"form-row\">\r\n          <div class=\"form-group\">\r\n            <label for=\"class_id\" class=\"form-label required\">班级ID</label>\r\n            <input\r\n              id=\"class_id\"\r\n              v-model=\"queryForm.class_id\"\r\n              type=\"text\"\r\n              placeholder=\"请输入班级ID\"\r\n              class=\"input\"\r\n            />\r\n          </div>\r\n          <div class=\"form-actions-inline\">\r\n            <button type=\"button\" class=\"button\" @click=\"loadComponents\" :disabled=\"loading\">\r\n              <span v-if=\"loading\">查询中...</span>\r\n              <span v-else>查询</span>\r\n            </button>\r\n            <button type=\"button\" class=\"button\" @click=\"showAddModal = true\">添加成绩项</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n\r\n    <!-- 成绩组成列表 -->\r\n    <section v-if=\"components.length > 0\" class=\"card components-card\">\r\n      <header class=\"card-header\">\r\n        <h3>成绩组成列表</h3>\r\n      </header>\r\n      <div class=\"components-table-wrapper\">\r\n        <table class=\"components-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>成绩项ID</th>\r\n              <th>成绩项名称</th>\r\n              <th>权重</th>\r\n              <th>满分</th>\r\n              <th>操作</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"component in components\" :key=\"component.component_id\">\r\n              <td>{{ component.component_id }}</td>\r\n              <td>{{ component.component_name }}</td>\r\n              <td>{{ (component.weight * 100).toFixed(1) }}%</td>\r\n              <td>{{ component.max_score }}</td>\r\n              <td>\r\n                <button type=\"button\" class=\"button button--outline button--small\" @click=\"editComponent(component)\">修改</button>\r\n                <button\r\n                  type=\"button\"\r\n                  class=\"button button--outline button--small\"\r\n                  style=\"margin-inline-start: 8px;\"\r\n                  @click=\"deleteComponent(component.component_id)\"\r\n                >\r\n                  删除\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </section>\r\n\r\n    <!-- 添加/修改模态框 -->\r\n    <div v-if=\"showAddModal || showEditModal\" class=\"modal-overlay\" @click=\"closeModal\">\r\n      <div class=\"modal-content\" @click.stop>\r\n        <div class=\"modal-header\">\r\n          <h3>{{ showEditModal ? '修改成绩组成' : '添加成绩组成' }}</h3>\r\n          <button class=\"modal-close\" @click=\"closeModal\">×</button>\r\n        </div>\r\n        <form @submit.prevent=\"handleSubmit\" class=\"modal-form\">\r\n          <div class=\"form-group\">\r\n            <label for=\"component_name\" class=\"form-label required\">成绩项名称</label>\r\n            <input\r\n              id=\"component_name\"\r\n              v-model=\"formData.component_name\"\r\n              type=\"text\"\r\n              placeholder=\"如：平时作业\"\r\n              class=\"input\"\r\n              :class=\"{ 'input--error': errors.component_name }\"\r\n            />\r\n            <p v-if=\"errors.component_name\" class=\"form-error\">{{ errors.component_name }}</p>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"weight\" class=\"form-label required\">权重</label>\r\n            <input\r\n              id=\"weight\"\r\n              v-model.number=\"formData.weight\"\r\n              type=\"number\"\r\n              placeholder=\"如：0.3（表示30%）\"\r\n              class=\"input\"\r\n              :class=\"{ 'input--error': errors.weight }\"\r\n              min=\"0\"\r\n              max=\"1\"\r\n              step=\"0.01\"\r\n            />\r\n            <p v-if=\"errors.weight\" class=\"form-error\">{{ errors.weight }}</p>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"max_score\" class=\"form-label required\">满分</label>\r\n            <input\r\n              id=\"max_score\"\r\n              v-model.number=\"formData.max_score\"\r\n              type=\"number\"\r\n              placeholder=\"如：100\"\r\n              class=\"input\"\r\n              :class=\"{ 'input--error': errors.max_score }\"\r\n              min=\"0\"\r\n              step=\"0.01\"\r\n            />\r\n            <p v-if=\"errors.max_score\" class=\"form-error\">{{ errors.max_score }}</p>\r\n          </div>\r\n          <div class=\"modal-actions\">\r\n            <button type=\"button\" class=\"button button--secondary\" @click=\"closeModal\">取消</button>\r\n            <button type=\"submit\" class=\"button\" :disabled=\"submitting\">\r\n              <span v-if=\"submitting\">保存中...</span>\r\n              <span v-else>保存</span>\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 空状态 -->\r\n    <section v-if=\"!loading && components.length === 0 && queryForm.class_id\" class=\"card empty-card\">\r\n      <div class=\"empty-state\">\r\n        <p>暂无成绩组成项，请添加</p>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted } from 'vue'\r\n\r\ndefineOptions({\r\n  name: 'GradesComposition'\r\n})\r\n\r\nconst queryForm = reactive({\r\n  class_id: ''\r\n})\r\n\r\nconst formData = reactive({\r\n  component_id: null,\r\n  component_name: '',\r\n  weight: null,\r\n  max_score: null\r\n})\r\n\r\nconst errors = reactive({})\r\nconst loading = ref(false)\r\nconst submitting = ref(false)\r\nconst components = ref([])\r\nconst showAddModal = ref(false)\r\nconst showEditModal = ref(false)\r\n\r\nonMounted(() => {\r\n  const classId = sessionStorage.getItem('selectedClassId')\r\n  if (classId) {\r\n    queryForm.class_id = classId\r\n  }\r\n})\r\n\r\nconst loadComponents = async () => {\r\n  if (!queryForm.class_id) {\r\n    alert('请填写班级ID')\r\n    return\r\n  }\r\n\r\n  loading.value = true\r\n  try {\r\n    const response = await fetch(\r\n      `http://127.0.0.1:8081/teacher/classes/${queryForm.class_id}/grade-components`,\r\n      {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        }\r\n      }\r\n    )\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({}))\r\n      throw new Error(errorData.msg || `请求失败: ${response.status}`)\r\n    }\r\n\r\n    const result = await response.json()\r\n\r\n    if (result.code === 1 && result.data) {\r\n      components.value = result.data || []\r\n    } else {\r\n      throw new Error(result.msg || '查询失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('查询成绩组成失败:', error)\r\n    alert(error instanceof Error ? error.message : '查询失败，请稍后重试')\r\n    components.value = []\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst editComponent = component => {\r\n  formData.component_id = component.component_id\r\n  formData.component_name = component.component_name\r\n  formData.weight = component.weight\r\n  formData.max_score = component.max_score\r\n  showEditModal.value = true\r\n}\r\n\r\nconst deleteComponent = async componentId => {\r\n  if (!confirm('确定要删除这个成绩组成项吗？')) return\r\n\r\n  try {\r\n    const response = await fetch(\r\n      `http://127.0.0.1:8081/teacher/classes/grade-components/${componentId}`,\r\n      {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        }\r\n      }\r\n    )\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({}))\r\n      throw new Error(errorData.msg || `请求失败: ${response.status}`)\r\n    }\r\n\r\n    const result = await response.json()\r\n\r\n    if (result.code === 1) {\r\n      alert('删除成功！')\r\n      loadComponents()\r\n    } else {\r\n      throw new Error(result.msg || '删除失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('删除成绩组成失败:', error)\r\n    alert(error instanceof Error ? error.message : '删除失败，请稍后重试')\r\n  }\r\n}\r\n\r\nconst validateForm = () => {\r\n  let isValid = true\r\n\r\n  if (!formData.component_name || formData.component_name.trim() === '') {\r\n    errors.component_name = '成绩项名称不能为空'\r\n    isValid = false\r\n  } else {\r\n    delete errors.component_name\r\n  }\r\n\r\n  if (formData.weight === null || formData.weight < 0 || formData.weight > 1) {\r\n    errors.weight = '权重必须在0-1之间'\r\n    isValid = false\r\n  } else {\r\n    delete errors.weight\r\n  }\r\n\r\n  if (formData.max_score === null || formData.max_score <= 0) {\r\n    errors.max_score = '满分必须大于0'\r\n    isValid = false\r\n  } else {\r\n    delete errors.max_score\r\n  }\r\n\r\n  return isValid\r\n}\r\n\r\nconst handleSubmit = async () => {\r\n  if (!validateForm()) return\r\n\r\n  submitting.value = true\r\n\r\n  try {\r\n    const url = showEditModal.value\r\n      ? 'http://127.0.0.1:8081/teacher/classes/grade-components'\r\n      : `http://127.0.0.1:8081/teacher/classes/${queryForm.class_id}/grade-components`\r\n\r\n    const method = showEditModal.value ? 'PUT' : 'POST'\r\n\r\n    const requestBody = {\r\n      component_name: formData.component_name.trim(),\r\n      weight: formData.weight,\r\n      max_score: formData.max_score\r\n    }\r\n\r\n    if (showEditModal.value && formData.component_id) {\r\n      requestBody.component_id = formData.component_id\r\n    }\r\n\r\n    const response = await fetch(url, {\r\n      method,\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify(requestBody)\r\n    })\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({}))\r\n      throw new Error(errorData.msg || `请求失败: ${response.status}`)\r\n    }\r\n\r\n    const result = await response.json()\r\n\r\n    if (result.code === 1) {\r\n      alert(showEditModal.value ? '修改成功！' : '添加成功！')\r\n      closeModal()\r\n      loadComponents()\r\n    } else {\r\n      throw new Error(result.msg || '操作失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('操作失败:', error)\r\n    alert(error instanceof Error ? error.message : '操作失败，请稍后重试')\r\n  } finally {\r\n    submitting.value = false\r\n  }\r\n}\r\n\r\nconst closeModal = () => {\r\n  showAddModal.value = false\r\n  showEditModal.value = false\r\n  formData.component_id = null\r\n  formData.component_name = ''\r\n  formData.weight = null\r\n  formData.max_score = null\r\n  Object.keys(errors).forEach(key => {\r\n    delete errors[key]\r\n  })\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.grades-composition {\r\n  padding: 24px;\r\n  max-inline-size: 1400px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.page-header {\r\n  margin-block-end: 24px;\r\n}\r\n\r\n.page-header h1 {\r\n  font-size: 24px;\r\n  font-weight: 600;\r\n  color: #333;\r\n  margin: 0 0 8px 0;\r\n}\r\n\r\n.page-description {\r\n  color: #666;\r\n  font-size: 14px;\r\n  margin: 0;\r\n}\r\n\r\n.filter-card,\r\n.components-card,\r\n.empty-card {\r\n  margin-block-start: 24px;\r\n}\r\n\r\n.card {\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  border: 1px solid #e8e8e8;\r\n  box-shadow: 0 6px 24px rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.card-header {\r\n  padding: 20px 24px;\r\n  border-block-end: 1px solid #f0f0f0;\r\n}\r\n\r\n.card-header h3 {\r\n  margin: 0;\r\n  font-size: 18px;\r\n  font-weight: 600;\r\n  color: #333;\r\n}\r\n\r\n.input {\r\n  inline-size: 100%;\r\n  padding: 8px 12px;\r\n  border: 1px solid #d9d9d9;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  transition: border-color 0.2s ease, box-shadow 0.2s ease;\r\n  outline: none;\r\n}\r\n\r\n.input:focus {\r\n  border-color: #2A5CAA;\r\n  box-shadow: 0 0 0 2px rgba(42, 92, 170, 0.1);\r\n}\r\n\r\n.input--error {\r\n  border-color: #ff4d4f;\r\n}\r\n\r\n.button {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 8px 16px;\r\n  border-radius: 4px;\r\n  border: none;\r\n  background: #2A5CAA;\r\n  color: #fff;\r\n  font-size: 14px;\r\n  cursor: pointer;\r\n  transition: background 0.2s ease, opacity 0.2s ease;\r\n}\r\n\r\n.button:hover:not(:disabled) {\r\n  background: #214a88;\r\n}\r\n\r\n.button:disabled {\r\n  opacity: 0.6;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.button--secondary {\r\n  background: #f5f5f5;\r\n  color: #333;\r\n  border: 1px solid #d9d9d9;\r\n}\r\n\r\n.button--outline {\r\n  background: #fff;\r\n  color: #2A5CAA;\r\n  border: 1px solid #2A5CAA;\r\n}\r\n\r\n.button--small {\r\n  padding: 4px 10px;\r\n  font-size: 12px;\r\n}\r\n\r\n.filter-form {\r\n  padding: 24px;\r\n}\r\n\r\n.form-row {\r\n  display: flex;\r\n  gap: 16px;\r\n  align-items: flex-end;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.form-group {\r\n  flex: 1;\r\n  min-inline-size: 200px;\r\n}\r\n\r\n.form-label {\r\n  display: block;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  color: #333;\r\n  margin-block-end: 8px;\r\n}\r\n\r\n.form-label.required::after {\r\n  content: ' *';\r\n  color: #ff4d4f;\r\n}\r\n\r\n.form-actions-inline {\r\n  display: flex;\r\n  gap: 12px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.components-table-wrapper {\r\n  overflow-x: auto;\r\n  padding: 16px;\r\n}\r\n\r\n.components-table {\r\n  inline-size: 100%;\r\n  border-collapse: collapse;\r\n  font-size: 14px;\r\n}\r\n\r\n.components-table th,\r\n.components-table td {\r\n  padding: 12px;\r\n  text-align: start;\r\n  border-block-end: 1px solid #e8e8e8;\r\n}\r\n\r\n.components-table th {\r\n  background: #fafafa;\r\n  font-weight: 600;\r\n  color: #333;\r\n}\r\n\r\n.components-table tbody tr:hover {\r\n  background: #f5f7fa;\r\n}\r\n\r\n.modal-overlay {\r\n  position: fixed;\r\n  inset: 0;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.modal-content {\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  inline-size: 90%;\r\n  max-inline-size: 500px;\r\n  max-block-size: 90vh;\r\n  overflow-y: auto;\r\n}\r\n\r\n.modal-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 20px;\r\n  border-block-end: 1px solid #e8e8e8;\r\n}\r\n\r\n.modal-header h3 {\r\n  margin: 0;\r\n  font-size: 18px;\r\n  font-weight: 600;\r\n  color: #333;\r\n}\r\n\r\n.modal-close {\r\n  background: none;\r\n  border: none;\r\n  font-size: 24px;\r\n  color: #999;\r\n  cursor: pointer;\r\n  padding: 0;\r\n  inline-size: 30px;\r\n  block-size: 30px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.modal-close:hover {\r\n  color: #333;\r\n}\r\n\r\n.modal-form {\r\n  padding: 20px;\r\n}\r\n\r\n.modal-actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 12px;\r\n  margin-block-start: 24px;\r\n}\r\n\r\n.empty-state {\r\n  padding: 48px;\r\n  text-align: center;\r\n  color: #999;\r\n  font-size: 16px;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}