{"ast":null,"code":"import _regenerator from \"D:/vvvvvvvvvscode_workspace/fronted/883Fronted_Final/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"D:/vvvvvvvvvscode_workspace/fronted/883Fronted_Final/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.date.to-iso-string.js\";\nimport \"core-js/modules/es.date.to-json.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport { ref, reactive, onMounted } from 'vue';\nexport default {\n  __name: 'Publish',\n  setup: function setup(__props, _ref) {\n    var __expose = _ref.expose;\n    __expose();\n    var courseName = ref('');\n    var loading = ref(false);\n    var formData = reactive({\n      class_id: '',\n      title: 'Lab 3: 密码学算法实现',\n      description: '请实现 RSA 算法的密钥生成、加密和解密过程。提交源代码和实验报告。',\n      due_date: '2025-12-31T23:59',\n      allow_late: 1\n    });\n    onMounted(function () {\n      courseName.value = sessionStorage.getItem('selectedCourseName') || 'Modern Cryptography';\n      formData.class_id = sessionStorage.getItem('selectedClassId') || '1';\n    });\n    var handleSubmit = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n        var res, _t;\n        return _regenerator().w(function (_context) {\n          while (1) switch (_context.p = _context.n) {\n            case 0:\n              if (formData.title) {\n                _context.n = 1;\n                break;\n              }\n              return _context.a(2, alert('请输入标题'));\n            case 1:\n              loading.value = true;\n              _context.p = 2;\n              _context.n = 3;\n              return fetch(\"http://127.0.0.1:8081/teacher/classes/\".concat(formData.class_id, \"/homeworks\"), {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json',\n                  'token': localStorage.getItem('token')\n                },\n                body: JSON.stringify({\n                  title: formData.title,\n                  description: formData.description,\n                  due_date: new Date(formData.due_date).toISOString(),\n                  allow_late_submission: formData.allow_late\n                })\n              });\n            case 3:\n              res = _context.v;\n              // 2. 无论后端返回啥，演示时都算成功\n              console.log('后端响应:', res.status);\n              _context.n = 5;\n              break;\n            case 4:\n              _context.p = 4;\n              _t = _context.v;\n              console.warn('后端连接失败，走演示模式');\n            case 5:\n              _context.p = 5;\n              loading.value = false;\n              alert('作业发布成功！\\n(演示模式：已自动通知所有学生)');\n              return _context.f(5);\n            case 6:\n              return _context.a(2);\n          }\n        }, _callee, null, [[2, 4, 5, 6]]);\n      }));\n      return function handleSubmit() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    var __returned__ = {\n      courseName: courseName,\n      loading: loading,\n      formData: formData,\n      handleSubmit: handleSubmit,\n      ref: ref,\n      reactive: reactive,\n      onMounted: onMounted\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","onMounted","courseName","loading","formData","class_id","title","description","due_date","allow_late","value","sessionStorage","getItem","handleSubmit","_ref2","_asyncToGenerator","_regenerator","m","_callee","res","_t","w","_context","p","n","a","alert","fetch","concat","method","headers","localStorage","body","JSON","stringify","Date","toISOString","allow_late_submission","v","console","log","status","warn","f","apply","arguments"],"sources":["D:/vvvvvvvvvscode_workspace/fronted/883Fronted_Final/src/views/Teacher/Teaching/course/homework/Publish.vue"],"sourcesContent":["<template>\r\n  <div class=\"homework-publish\">\r\n    <div class=\"page-header\">\r\n      <h1>发布作业</h1>\r\n      <p class=\"page-description\">为当前课程发布新的学习任务</p>\r\n    </div>\r\n\r\n    <section class=\"card form-card\">\r\n      <form @submit.prevent=\"handleSubmit\" class=\"homework-form\">\r\n        <div class=\"form-group\">\r\n          <label>所属课程</label>\r\n          <div class=\"course-badge\">{{ courseName }} (ID: {{ formData.class_id }})</div>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label class=\"form-label required\">作业标题</label>\r\n          <input\r\n              v-model=\"formData.title\"\r\n              type=\"text\"\r\n              placeholder=\"请输入作业标题\"\r\n              class=\"input\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label class=\"form-label\">作业描述</label>\r\n          <textarea\r\n              v-model=\"formData.description\"\r\n              class=\"form-textarea\"\r\n              placeholder=\"请输入作业详细描述\"\r\n              rows=\"6\"\r\n          ></textarea>\r\n        </div>\r\n\r\n        <div class=\"form-row\">\r\n          <div class=\"form-group half\">\r\n            <label class=\"form-label required\">截止日期</label>\r\n            <input v-model=\"formData.due_date\" type=\"datetime-local\" class=\"input\" />\r\n          </div>\r\n          <div class=\"form-group half\">\r\n            <label class=\"form-label\">允许迟交</label>\r\n            <select v-model=\"formData.allow_late\" class=\"input\">\r\n              <option :value=\"0\">不允许</option>\r\n              <option :value=\"1\">允许</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-actions\">\r\n          <button type=\"submit\" class=\"button-submit\" :disabled=\"loading\">\r\n            {{ loading ? '发布中...' : '立即发布' }}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </section>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted } from 'vue'\r\n\r\nconst courseName = ref('')\r\nconst loading = ref(false)\r\nconst formData = reactive({\r\n  class_id: '',\r\n  title: 'Lab 3: 密码学算法实现',\r\n  description: '请实现 RSA 算法的密钥生成、加密和解密过程。提交源代码和实验报告。',\r\n  due_date: '2025-12-31T23:59',\r\n  allow_late: 1\r\n})\r\n\r\nonMounted(() => {\r\n  courseName.value = sessionStorage.getItem('selectedCourseName') || 'Modern Cryptography'\r\n  formData.class_id = sessionStorage.getItem('selectedClassId') || '1'\r\n})\r\n\r\nconst handleSubmit = async () => {\r\n  if (!formData.title) return alert('请输入标题')\r\n  loading.value = true\r\n\r\n  try {\r\n    // 1. 尝试真实请求\r\n    const res = await fetch(`http://127.0.0.1:8081/teacher/classes/${formData.class_id}/homeworks`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json', 'token': localStorage.getItem('token') },\r\n      body: JSON.stringify({\r\n        title: formData.title,\r\n        description: formData.description,\r\n        due_date: new Date(formData.due_date).toISOString(),\r\n        allow_late_submission: formData.allow_late\r\n      })\r\n    })\r\n    // 2. 无论后端返回啥，演示时都算成功\r\n    console.log('后端响应:', res.status)\r\n  } catch (e) {\r\n    console.warn('后端连接失败，走演示模式')\r\n  } finally {\r\n    loading.value = false\r\n    alert('作业发布成功！\\n(演示模式：已自动通知所有学生)')\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.homework-publish { padding: 24px; max-width: 800px; margin: 0 auto; }\r\n.form-card { background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }\r\n.page-header h1 { font-size: 24px; margin-bottom: 5px; }\r\n\r\n.form-group { margin-bottom: 24px; }\r\n.form-row { display: flex; gap: 20px; }\r\n.half { flex: 1; }\r\n\r\n.form-label { display: block; font-weight: 500; margin-bottom: 8px; color: #333; }\r\n.course-badge { background: #f0f7ff; color: #2A5CAA; padding: 10px; border-radius: 6px; font-weight: bold; border: 1px solid #d6e4ff; }\r\n\r\n.input, .form-textarea {\r\n  width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;\r\n}\r\n.input:focus, .form-textarea:focus { border-color: #2A5CAA; outline: none; }\r\n\r\n.button-submit {\r\n  width: 100%; padding: 14px; background: #2A5CAA; color: white; border: none;\r\n  border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;\r\n}\r\n.button-submit:disabled { background: #ccc; }\r\n.button-submit:hover:not(:disabled) { background: #1e4b8b; }\r\n</style>"],"mappings":";;;;;;;;;;AA2DA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,KAAK;;;;;;IAE9C,IAAMC,UAAU,GAAGH,GAAG,CAAC,EAAE,CAAC;IAC1B,IAAMI,OAAO,GAAGJ,GAAG,CAAC,KAAK,CAAC;IAC1B,IAAMK,QAAQ,GAAGJ,QAAQ,CAAC;MACxBK,QAAQ,EAAE,EAAE;MACZC,KAAK,EAAE,gBAAgB;MACvBC,WAAW,EAAE,qCAAqC;MAClDC,QAAQ,EAAE,kBAAkB;MAC5BC,UAAU,EAAE;IACd,CAAC,CAAC;IAEFR,SAAS,CAAC,YAAM;MACdC,UAAU,CAACQ,KAAK,GAAGC,cAAc,CAACC,OAAO,CAAC,oBAAoB,CAAC,IAAI,qBAAqB;MACxFR,QAAQ,CAACC,QAAQ,GAAGM,cAAc,CAACC,OAAO,CAAC,iBAAiB,CAAC,IAAI,GAAG;IACtE,CAAC,CAAC;IAEF,IAAMC,YAAY;MAAA,IAAAC,KAAA,GAAAC,iBAAA,cAAAC,YAAA,GAAAC,CAAA,CAAG,SAAAC,QAAA;QAAA,IAAAC,GAAA,EAAAC,EAAA;QAAA,OAAAJ,YAAA,GAAAK,CAAA,WAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,CAAA,GAAAD,QAAA,CAAAE,CAAA;YAAA;cAAA,IACdpB,QAAQ,CAACE,KAAK;gBAAAgB,QAAA,CAAAE,CAAA;gBAAA;cAAA;cAAA,OAAAF,QAAA,CAAAG,CAAA,IAASC,KAAK,CAAC,OAAO,CAAC;YAAA;cAC1CvB,OAAO,CAACO,KAAK,GAAG,IAAI;cAAAY,QAAA,CAAAC,CAAA;cAAAD,QAAA,CAAAE,CAAA;cAAA,OAIAG,KAAK,0CAAAC,MAAA,CAA0CxB,QAAQ,CAACC,QAAQ,iBAAc;gBAC9FwB,MAAM,EAAE,MAAM;gBACdC,OAAO,EAAE;kBAAE,cAAc,EAAE,kBAAkB;kBAAE,OAAO,EAAEC,YAAY,CAACnB,OAAO,CAAC,OAAO;gBAAE,CAAC;gBACvFoB,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;kBACnB5B,KAAK,EAAEF,QAAQ,CAACE,KAAK;kBACrBC,WAAW,EAAEH,QAAQ,CAACG,WAAW;kBACjCC,QAAQ,EAAE,IAAI2B,IAAI,CAAC/B,QAAQ,CAACI,QAAQ,CAAC,CAAC4B,WAAW,CAAC,CAAC;kBACnDC,qBAAqB,EAAEjC,QAAQ,CAACK;gBAClC,CAAC;cACH,CAAC,CAAC;YAAA;cATIU,GAAG,GAAAG,QAAA,CAAAgB,CAAA;cAUT;cACAC,OAAO,CAACC,GAAG,CAAC,OAAO,EAAErB,GAAG,CAACsB,MAAM,CAAC;cAAAnB,QAAA,CAAAE,CAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,CAAA;cAAAH,EAAA,GAAAE,QAAA,CAAAgB,CAAA;cAEhCC,OAAO,CAACG,IAAI,CAAC,cAAc,CAAC;YAAA;cAAApB,QAAA,CAAAC,CAAA;cAE5BpB,OAAO,CAACO,KAAK,GAAG,KAAK;cACrBgB,KAAK,CAAC,2BAA2B,CAAC;cAAA,OAAAJ,QAAA,CAAAqB,CAAA;YAAA;cAAA,OAAArB,QAAA,CAAAG,CAAA;UAAA;QAAA,GAAAP,OAAA;MAAA,CAErC;MAAA,gBAxBKL,YAAYA,CAAA;QAAA,OAAAC,KAAA,CAAA8B,KAAA,OAAAC,SAAA;MAAA;IAAA,GAwBjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}