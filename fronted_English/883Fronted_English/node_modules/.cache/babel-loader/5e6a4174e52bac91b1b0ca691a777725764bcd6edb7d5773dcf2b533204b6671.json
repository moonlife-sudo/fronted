{"ast":null,"code":"import { ref, reactive, onMounted, computed } from 'vue';\nimport { useRouter } from 'vue-router';\nconst BAIDU_AK = '3Jbw6qq8jVSn3CzXu0btBU2lpgffWz5G';\nexport default {\n  __name: 'Launch',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const showMap = ref(false);\n    const courseName = ref('');\n    const addressName = ref('');\n    const loading = ref(false);\n\n    // ‰Ω†ÁöÑÁôæÂ∫¶Âú∞Âõæ AK\n    const mapUrl = computed(() => {\n      return `https://api.map.baidu.com/marker?location=39.916979519873,116.41004950566&title=ÊïôÂÆ§‰ΩçÁΩÆ&content=ËØ∑Á°ÆËÆ§‰ΩçÁΩÆ&output=html&src=webapp.baidu.openAPIdemo&ak=${BAIDU_AK}`;\n    });\n    const formData = reactive({\n      class_id: '',\n      session_type: 1,\n      duration: 10,\n      required_latitude: null,\n      required_longitude: null,\n      required_radius: 100\n    });\n    const hasLocation = computed(() => formData.required_latitude && formData.required_longitude);\n    onMounted(() => {\n      courseName.value = sessionStorage.getItem('selectedCourseName') || 'Modern Cryptography';\n      formData.class_id = sessionStorage.getItem('selectedClassId') || '1';\n    });\n    const openMapModal = () => {\n      showMap.value = true;\n    };\n    const confirmLocation = () => {\n      formData.required_latitude = 30.5133;\n      formData.required_longitude = 114.3640;\n      addressName.value = \"Selected: Teaching Building N201\";\n      showMap.value = false;\n    };\n    const handleSubmit = async () => {\n      loading.value = true;\n      try {\n        // Â∞ùËØïÁúüÂÆûËØ∑Ê±Ç\n        await fetch(`http://127.0.0.1:8081/teacher/classes/${formData.class_id}/attendance/start`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'token': localStorage.getItem('token')\n          },\n          body: JSON.stringify(formData)\n        });\n      } catch (e) {\n        console.warn('ÂêéÁ´ØËøûÊé•Â§±Ë¥•ÔºåËµ∞ÊºîÁ§∫Ê®°Âºè');\n      } finally {\n        loading.value = false;\n        alert(`Sign-in launched!\\nType: ${formData.session_type === 1 ? 'Normal' : 'Location-based'}\\nDuration: ${formData.duration} minutes`);\n        router.push('detail');\n      }\n    };\n    const __returned__ = {\n      router,\n      showMap,\n      courseName,\n      addressName,\n      loading,\n      BAIDU_AK,\n      mapUrl,\n      formData,\n      hasLocation,\n      openMapModal,\n      confirmLocation,\n      handleSubmit,\n      ref,\n      reactive,\n      onMounted,\n      computed,\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","onMounted","computed","useRouter","BAIDU_AK","router","showMap","courseName","addressName","loading","mapUrl","formData","class_id","session_type","duration","required_latitude","required_longitude","required_radius","hasLocation","value","sessionStorage","getItem","openMapModal","confirmLocation","handleSubmit","fetch","method","headers","localStorage","body","JSON","stringify","e","console","warn","alert","push"],"sources":["/Users/zhouzhou/Downloads/fronted-fronted_new/883Fronted_English/src/views/Teacher/Teaching/course/attendance/Launch.vue"],"sourcesContent":["<template>\n  <div class=\"attendance-launch\">\n    <div class=\"page-header\">\n      <h1>Launch Attendance</h1>\n      <p class=\"page-description\">Set attendance rules and scope</p>\n    </div>\n\n    <section class=\"card form-card\">\n      <form @submit.prevent=\"handleSubmit\" class=\"attendance-form\">\n        <div class=\"form-group\">\n          <label>Current Course</label>\n          <div class=\"course-badge\">\n            <span class=\"course-name\">{{ courseName }}</span>\n            <span class=\"course-id\">ID: {{ formData.class_id }}</span>\n          </div>\n        </div>\n\n        <div class=\"form-group\">\n          <label>Attendance Type</label>\n          <div class=\"type-selector\">\n            <div class=\"type-card\" :class=\"{ active: formData.session_type === 1 }\" @click=\"formData.session_type = 1\">\n              <i class=\"bi bi-person-bounding-box\"></i> Normal Attendance\n            </div>\n            <div class=\"type-card\" :class=\"{ active: formData.session_type === 2 }\" @click=\"formData.session_type = 2\">\n              <i class=\"bi bi-geo-alt-fill\"></i> Location-based Attendance\n            </div>\n          </div>\n        </div>\n\n        <div class=\"form-group\">\n          <label>Attendance Duration</label>\n          <div class=\"duration-options\">\n            <span v-for=\"t in [5, 10, 15, 30]\" :key=\"t\" class=\"tag\" :class=\"{ active: formData.duration === t }\"\n              @click=\"formData.duration = t\">{{ t }} minutes</span>\n          </div>\n        </div>\n\n        <div v-if=\"formData.session_type === 2\" class=\"location-box\">\n          <label class=\"section-label\">üìç Attendance Location Settings</label>\n\n          <div class=\"map-preview\" v-if=\"!hasLocation\">\n            <button type=\"button\" class=\"btn-map\" @click=\"openMapModal\">\n              <i class=\"bi bi-map\"></i> Open Map to Select Location\n            </button>\n            <p class=\"hint\">Click the button to select classroom location on the map</p>\n          </div>\n\n          <div class=\"location-result\" v-else>\n            <div class=\"coord-info\">\n              <div class=\"res-item\"><strong>Latitude: </strong>{{ formData.required_latitude }}</div>\n              <div class=\"res-item\"><strong>Longitude: </strong>{{ formData.required_longitude }}</div>\n              <div class=\"res-item address\"><strong>Address: </strong>{{ addressName }}</div>\n            </div>\n            <button type=\"button\" class=\"btn-reselect\" @click=\"openMapModal\">Reselect</button>\n          </div>\n\n          <div class=\"radius-setting\">\n            <label>Allowable Radius: {{ formData.required_radius }} meters</label>\n            <input type=\"range\" v-model=\"formData.required_radius\" min=\"50\" max=\"500\" step=\"50\">\n          </div>\n        </div>\n\n        <div class=\"form-actions\">\n          <button type=\"button\" class=\"button-submit\" @click=\"handleSubmit\" :disabled=\"loading\">\n            {{ loading ? 'Launching...' : 'Launch Now' }}\n          </button>\n        </div>\n      </form>\n    </section>\n\n    <div v-if=\"showMap\" class=\"map-modal-overlay\">\n      <div class=\"map-modal\">\n        <div class=\"map-header\">\n          <h3>Please click on the map to select location</h3>\n          <span class=\"close\" @click=\"showMap = false\">√ó</span>\n        </div>\n        <div class=\"map-body\">\n          <iframe id=\"mapPage\" width=\"100%\" height=\"100%\" frameborder=\"0\" :src=\"mapUrl\"></iframe>\n        </div>\n        <div class=\"map-footer\">\n          <p class=\"tip\">Tip: After finding the classroom location on the map, click confirm below (Demo Mode)</p>\n          <button class=\"button-confirm\" @click=\"confirmLocation\">I've selected a location (Confirm)</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted, computed } from 'vue'\nimport { useRouter } from 'vue-router'\n\nconst router = useRouter()\nconst showMap = ref(false)\nconst courseName = ref('')\nconst addressName = ref('')\nconst loading = ref(false)\n\n// ‰Ω†ÁöÑÁôæÂ∫¶Âú∞Âõæ AK\nconst BAIDU_AK = '3Jbw6qq8jVSn3CzXu0btBU2lpgffWz5G'\n\nconst mapUrl = computed(() => {\n  return `https://api.map.baidu.com/marker?location=39.916979519873,116.41004950566&title=ÊïôÂÆ§‰ΩçÁΩÆ&content=ËØ∑Á°ÆËÆ§‰ΩçÁΩÆ&output=html&src=webapp.baidu.openAPIdemo&ak=${BAIDU_AK}`\n})\n\nconst formData = reactive({\n  class_id: '',\n  session_type: 1,\n  duration: 10,\n  required_latitude: null,\n  required_longitude: null,\n  required_radius: 100\n})\n\nconst hasLocation = computed(() => formData.required_latitude && formData.required_longitude)\n\nonMounted(() => {\n  courseName.value = sessionStorage.getItem('selectedCourseName') || 'Modern Cryptography'\n  formData.class_id = sessionStorage.getItem('selectedClassId') || '1'\n})\n\nconst openMapModal = () => {\n  showMap.value = true\n}\n\nconst confirmLocation = () => {\n  formData.required_latitude = 30.5133\n  formData.required_longitude = 114.3640\n  addressName.value = \"Selected: Teaching Building N201\"\n  showMap.value = false\n}\n\nconst handleSubmit = async () => {\n  loading.value = true\n  try {\n    // Â∞ùËØïÁúüÂÆûËØ∑Ê±Ç\n    await fetch(`http://127.0.0.1:8081/teacher/classes/${formData.class_id}/attendance/start`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json', 'token': localStorage.getItem('token') },\n      body: JSON.stringify(formData)\n    })\n  } catch (e) {\n    console.warn('ÂêéÁ´ØËøûÊé•Â§±Ë¥•ÔºåËµ∞ÊºîÁ§∫Ê®°Âºè')\n  } finally {\n    loading.value = false\n    alert(`Sign-in launched!\\nType: ${formData.session_type === 1 ? 'Normal' : 'Location-based'}\\nDuration: ${formData.duration} minutes`)\n    router.push('detail')\n  }\n}\n</script>\n\n<style scoped>\n/* Ê†∑Âºè‰øùÊåÅ‰∏çÂèòÔºåÁõ¥Êé•Â§çÁî®‰∏ä‰∏ÄÊ¨°ÁöÑ */\n.attendance-launch {\n  padding: 24px;\n  max-inline-size: 800px;\n  margin: 0 auto;\n}\n\n.page-header h1 {\n  color: #333;\n  margin-block-end: 5px;\n}\n\n.form-card {\n  background: #fff;\n  padding: 30px;\n  border-radius: 12px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n}\n\n.form-group {\n  margin-block-end: 25px;\n}\n\n.form-group label {\n  display: block;\n  font-weight: 600;\n  margin-block-end: 10px;\n  color: #444;\n}\n\n.course-badge {\n  background: #f0f7ff;\n  border: 1px solid #2A5CAA;\n  border-radius: 8px;\n  padding: 12px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  color: #2A5CAA;\n}\n\n.course-name {\n  font-weight: bold;\n  font-size: 16px;\n}\n\n.course-id {\n  font-size: 13px;\n  opacity: 0.8;\n}\n\n.type-selector {\n  display: flex;\n  gap: 20px;\n}\n\n.type-card {\n  flex: 1;\n  border: 2px solid #eee;\n  padding: 20px;\n  border-radius: 10px;\n  text-align: center;\n  cursor: pointer;\n  transition: all 0.3s;\n}\n\n.type-card:hover {\n  border-color: #b3c7f9;\n}\n\n.type-card.active {\n  border-color: #2A5CAA;\n  background: #eef2ff;\n  color: #2A5CAA;\n  font-weight: bold;\n}\n\n.type-card i {\n  font-size: 24px;\n  display: block;\n  margin-block-end: 8px;\n}\n\n.duration-options {\n  display: flex;\n  gap: 10px;\n}\n\n.tag {\n  padding: 8px 16px;\n  background: #f5f5f5;\n  border-radius: 20px;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.tag.active {\n  background: #2A5CAA;\n  color: white;\n}\n\n.location-box {\n  background: #f9fafb;\n  padding: 20px;\n  border-radius: 8px;\n  border: 1px dashed #ccc;\n}\n\n.btn-map {\n  inline-size: 100%;\n  padding: 15px;\n  background: white;\n  border: 1px solid #2A5CAA;\n  color: #2A5CAA;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n}\n\n.location-result {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: white;\n  padding: 15px;\n  border-radius: 8px;\n}\n\n.res-item {\n  font-size: 13px;\n  color: #555;\n  margin-block-end: 4px;\n}\n\n.btn-reselect {\n  background: none;\n  border: none;\n  color: #2A5CAA;\n  cursor: pointer;\n  text-decoration: underline;\n}\n\n.button-submit {\n  inline-size: 100%;\n  padding: 14px;\n  background: #2A5CAA;\n  color: white;\n  border: none;\n  border-radius: 8px;\n  font-size: 16px;\n  font-weight: 600;\n  cursor: pointer;\n  margin-block-start: 20px;\n}\n\n.button-submit:hover:not(:disabled) {\n  background: #1e4b8b;\n}\n\n.button-submit:disabled {\n  background: #ccc;\n}\n\n.map-modal-overlay {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.6);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.map-modal {\n  background: white;\n  inline-size: 90%;\n  max-inline-size: 700px;\n  block-size: 80vh;\n  border-radius: 12px;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n\n.map-header {\n  padding: 15px;\n  display: flex;\n  justify-content: space-between;\n  border-block-end: 1px solid #eee;\n  background: #f5f5f5;\n}\n\n.map-header .close {\n  font-size: 24px;\n  cursor: pointer;\n}\n\n.map-body {\n  flex: 1;\n  position: relative;\n}\n\n.map-footer {\n  padding: 15px;\n  text-align: center;\n  background: #fff;\n  border-block-start: 1px solid #eee;\n}\n\n.button-confirm {\n  background: #2A5CAA;\n  color: white;\n  border: none;\n  padding: 10px 40px;\n  border-radius: 20px;\n  cursor: pointer;\n  font-weight: bold;\n}\n</style>"],"mappings":"AAyFA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,KAAI;AACvD,SAASC,SAAS,QAAQ,YAAW;AASrC,MAAMC,QAAQ,GAAG,kCAAiC;;;;;;;IAPlD,MAAMC,MAAM,GAAGF,SAAS,CAAC;IACzB,MAAMG,OAAO,GAAGP,GAAG,CAAC,KAAK;IACzB,MAAMQ,UAAU,GAAGR,GAAG,CAAC,EAAE;IACzB,MAAMS,WAAW,GAAGT,GAAG,CAAC,EAAE;IAC1B,MAAMU,OAAO,GAAGV,GAAG,CAAC,KAAK;;IAEzB;IAGA,MAAMW,MAAM,GAAGR,QAAQ,CAAC,MAAM;MAC5B,OAAO,kJAAkJE,QAAQ,EAAC;IACpK,CAAC;IAED,MAAMO,QAAQ,GAAGX,QAAQ,CAAC;MACxBY,QAAQ,EAAE,EAAE;MACZC,YAAY,EAAE,CAAC;MACfC,QAAQ,EAAE,EAAE;MACZC,iBAAiB,EAAE,IAAI;MACvBC,kBAAkB,EAAE,IAAI;MACxBC,eAAe,EAAE;IACnB,CAAC;IAED,MAAMC,WAAW,GAAGhB,QAAQ,CAAC,MAAMS,QAAQ,CAACI,iBAAiB,IAAIJ,QAAQ,CAACK,kBAAkB;IAE5Ff,SAAS,CAAC,MAAM;MACdM,UAAU,CAACY,KAAK,GAAGC,cAAc,CAACC,OAAO,CAAC,oBAAoB,CAAC,IAAI,qBAAoB;MACvFV,QAAQ,CAACC,QAAQ,GAAGQ,cAAc,CAACC,OAAO,CAAC,iBAAiB,CAAC,IAAI,GAAE;IACrE,CAAC;IAED,MAAMC,YAAY,GAAGA,CAAA,KAAM;MACzBhB,OAAO,CAACa,KAAK,GAAG,IAAG;IACrB;IAEA,MAAMI,eAAe,GAAGA,CAAA,KAAM;MAC5BZ,QAAQ,CAACI,iBAAiB,GAAG,OAAM;MACnCJ,QAAQ,CAACK,kBAAkB,GAAG,QAAO;MACrCR,WAAW,CAACW,KAAK,GAAG,kCAAiC;MACrDb,OAAO,CAACa,KAAK,GAAG,KAAI;IACtB;IAEA,MAAMK,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/Bf,OAAO,CAACU,KAAK,GAAG,IAAG;MACnB,IAAI;QACF;QACA,MAAMM,KAAK,CAAC,yCAAyCd,QAAQ,CAACC,QAAQ,mBAAmB,EAAE;UACzFc,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YAAE,cAAc,EAAE,kBAAkB;YAAE,OAAO,EAAEC,YAAY,CAACP,OAAO,CAAC,OAAO;UAAE,CAAC;UACvFQ,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACpB,QAAQ;QAC/B,CAAC;MACH,CAAC,CAAC,OAAOqB,CAAC,EAAE;QACVC,OAAO,CAACC,IAAI,CAAC,cAAc;MAC7B,CAAC,SAAS;QACRzB,OAAO,CAACU,KAAK,GAAG,KAAI;QACpBgB,KAAK,CAAC,4BAA4BxB,QAAQ,CAACE,YAAY,KAAK,CAAC,GAAG,QAAQ,GAAG,gBAAgB,eAAeF,QAAQ,CAACG,QAAQ,UAAU;QACrIT,MAAM,CAAC+B,IAAI,CAAC,QAAQ;MACtB;IACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}