{"ast":null,"code":"import { reactive, ref, onMounted, watch } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { useStore } from 'vuex';\nexport default {\n  __name: 'Apply',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const store = useStore();\n    const submitting = ref(false);\n    const courseName = ref('');\n    const form = reactive({\n      type: 'sick',\n      start: '',\n      end: '',\n      reason: ''\n    });\n    const startDatetime = ref(null);\n    const endDatetime = ref(null);\n    const displayStart = ref('');\n    const displayEnd = ref('');\n    onMounted(() => {\n      courseName.value = localStorage.getItem('currentCourseName') || 'Modern Cryptography';\n    });\n\n    // Êõ¥Êñ∞ÊòæÁ§∫ÁöÑÊó∂Èó¥Â≠óÁ¨¶‰∏≤\n    function updateDisplayStart() {\n      displayStart.value = formatDateTime(form.start);\n    }\n    function updateDisplayEnd() {\n      displayEnd.value = formatDateTime(form.end);\n    }\n\n    // Ê†ºÂºèÂåñÊó•ÊúüÊó∂Èó¥‰∏∫YYYY-MM-DD HH:MMÊ†ºÂºè\n    function formatDateTime(dateString) {\n      if (!dateString) return '';\n      const date = new Date(dateString);\n      const year = date.getFullYear();\n      const month = String(date.getMonth() + 1).padStart(2, '0');\n      const day = String(date.getDate()).padStart(2, '0');\n      const hours = String(date.getHours()).padStart(2, '0');\n      const minutes = String(date.getMinutes()).padStart(2, '0');\n      return `${year}-${month}-${day} ${hours}:${minutes}`;\n    }\n\n    // ÁõëÂê¨form.startÂíåform.endÁöÑÂèòÂåñÔºåÊõ¥Êñ∞ÊòæÁ§∫\n    watch(() => form.start, newValue => {\n      updateDisplayStart();\n    });\n    watch(() => form.end, newValue => {\n      updateDisplayEnd();\n    });\n    const submit = async () => {\n      if (!form.reason) {\n        alert('Please fill in the leave reason');\n        return;\n      }\n      if (!form.start || !form.end) {\n        alert('Please select leave time');\n        return;\n      }\n      if (new Date(form.start) >= new Date(form.end)) {\n        alert('End time must be later than start time');\n        return;\n      }\n      try {\n        submitting.value = true;\n\n        // ÈÄöËøáVuexÊèê‰∫§ËØ∑ÂÅáÁî≥ËØ∑\n        await store.dispatch('submitLeaveApplication', {\n          type: form.type,\n          start: form.start,\n          end: form.end,\n          reason: form.reason,\n          courseName: courseName.value\n        });\n        alert('Leave application submitted, waiting for teacher approval');\n\n        // Navigate to records page\n        router.push('records');\n      } catch (error) {\n        console.error('Failed to submit leave application:', error);\n        alert('Submission failed, please try again later');\n      } finally {\n        submitting.value = false;\n      }\n    };\n    const __returned__ = {\n      router,\n      store,\n      submitting,\n      courseName,\n      form,\n      startDatetime,\n      endDatetime,\n      displayStart,\n      displayEnd,\n      updateDisplayStart,\n      updateDisplayEnd,\n      formatDateTime,\n      submit,\n      reactive,\n      ref,\n      onMounted,\n      watch,\n      get useRouter() {\n        return useRouter;\n      },\n      get useStore() {\n        return useStore;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["reactive","ref","onMounted","watch","useRouter","useStore","router","store","submitting","courseName","form","type","start","end","reason","startDatetime","endDatetime","displayStart","displayEnd","value","localStorage","getItem","updateDisplayStart","formatDateTime","updateDisplayEnd","dateString","date","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","newValue","submit","alert","dispatch","push","error","console"],"sources":["/Users/zhouzhou/Downloads/fronted-fronted_new/883Fronted_English/src/views/Student/Teaching/course/leave/Apply.vue"],"sourcesContent":["<template>\n  <div class=\"leave-apply\">\n    <div class=\"card form-card\">\n      <h3>üìÖ Fill Leave Application</h3>\n      <div class=\"form-group\">\n        <label>Course</label>\n        <input type=\"text\" :value=\"courseName\" readonly class=\"course-input\">\n      </div>\n      <div class=\"form-group\">\n        <label>Leave Type</label>\n        <select v-model=\"form.type\">\n          <option value=\"sick\">Sick Leave</option>\n          <option value=\"personal\">Personal Leave</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>Time Range</label>\n        <div class=\"date-row\">\n          <div class=\"datetime-container\">\n            <input type=\"datetime-local\" v-model=\"form.start\" ref=\"startDatetime\" class=\"hidden-datetime\" @change=\"updateDisplayStart\">\n            <input type=\"text\" v-model=\"displayStart\" placeholder=\"YYYY-MM-DD HH:MM\" class=\"visible-text\">\n          </div>\n          <span class=\"to-text\">to</span>\n          <div class=\"datetime-container\">\n            <input type=\"datetime-local\" v-model=\"form.end\" ref=\"endDatetime\" class=\"hidden-datetime\" @change=\"updateDisplayEnd\">\n            <input type=\"text\" v-model=\"displayEnd\" placeholder=\"YYYY-MM-DD HH:MM\" class=\"visible-text\">\n          </div>\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label>Leave Reason</label>\n        <textarea v-model=\"form.reason\" rows=\"4\" placeholder=\"Please explain the leave reason in detail...\"></textarea>\n      </div>\n      <button class=\"submit-btn\" @click=\"submit\" :disabled=\"submitting\">\n        {{ submitting ? 'Submitting...' : 'Submit Application' }}\n      </button>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { reactive, ref, onMounted, watch } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useStore } from 'vuex'\n\nconst router = useRouter()\nconst store = useStore()\nconst submitting = ref(false)\nconst courseName = ref('')\nconst form = reactive({ type: 'sick', start: '', end: '', reason: '' })\nconst startDatetime = ref(null)\nconst endDatetime = ref(null)\nconst displayStart = ref('')\nconst displayEnd = ref('')\n\nonMounted(() => {\n  courseName.value = localStorage.getItem('currentCourseName') || 'Modern Cryptography'\n})\n\n// Êõ¥Êñ∞ÊòæÁ§∫ÁöÑÊó∂Èó¥Â≠óÁ¨¶‰∏≤\nfunction updateDisplayStart() {\n  displayStart.value = formatDateTime(form.start)\n}\n\nfunction updateDisplayEnd() {\n  displayEnd.value = formatDateTime(form.end)\n}\n\n// Ê†ºÂºèÂåñÊó•ÊúüÊó∂Èó¥‰∏∫YYYY-MM-DD HH:MMÊ†ºÂºè\nfunction formatDateTime(dateString) {\n  if (!dateString) return ''\n  const date = new Date(dateString)\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, '0')\n  const day = String(date.getDate()).padStart(2, '0')\n  const hours = String(date.getHours()).padStart(2, '0')\n  const minutes = String(date.getMinutes()).padStart(2, '0')\n  return `${year}-${month}-${day} ${hours}:${minutes}`\n}\n\n// ÁõëÂê¨form.startÂíåform.endÁöÑÂèòÂåñÔºåÊõ¥Êñ∞ÊòæÁ§∫\nwatch(() => form.start, (newValue) => {\n  updateDisplayStart()\n})\n\nwatch(() => form.end, (newValue) => {\n  updateDisplayEnd()\n})\n\nconst submit = async () => {\n  if (!form.reason) {\n    alert('Please fill in the leave reason')\n    return\n  }\n  \n  if (!form.start || !form.end) {\n    alert('Please select leave time')\n    return\n  }\n  \n  if (new Date(form.start) >= new Date(form.end)) {\n    alert('End time must be later than start time')\n    return\n  }\n  \n  try {\n    submitting.value = true\n    \n    // ÈÄöËøáVuexÊèê‰∫§ËØ∑ÂÅáÁî≥ËØ∑\n    await store.dispatch('submitLeaveApplication', {\n      type: form.type,\n      start: form.start,\n      end: form.end,\n      reason: form.reason,\n      courseName: courseName.value\n    })\n    \n    alert('Leave application submitted, waiting for teacher approval')\n    \n    // Navigate to records page\n    router.push('records')\n    \n  } catch (error) {\n    console.error('Failed to submit leave application:', error)\n    alert('Submission failed, please try again later')\n  } finally {\n    submitting.value = false\n  }\n}\n</script>\n\n<style scoped>\n.leave-apply { padding: 24px; max-width: 800px; margin: 0 auto; }\n.card { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05); }\n h3 { margin-top: 0; margin-bottom: 24px; color: #333; }\n.form-group { margin-bottom: 20px; }\nlabel { display: block; margin-bottom: 8px; font-weight: 500; color: #666; }\nselect, textarea, .course-input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }\n.date-row { display: flex; gap: 10px; align-items: center; }\n.datetime-container {\n  position: relative;\n  flex: 1;\n}\n.hidden-datetime {\n  position: absolute;\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  z-index: 2;\n  cursor: pointer;\n}\n\n.visible-text {\n  width: 100%;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  box-sizing: border-box;\n  font-family: Arial, sans-serif;\n  color: #333;\n  position: relative;\n}\n\n.calendar-icon {\n  position: absolute;\n  right: 10px;\n  top: 50%;\n  transform: translateY(-50%);\n  cursor: pointer;\n  color: #666;\n  font-size: 16px;\n  z-index: 3;\n}\n\n.calendar-icon:hover {\n  color: #2A5CAA;\n}\n.course-input { background:#f5f5f5; color:#666; }\n.to-text {\n  margin: 0 5px;\n  color: #666;\n}\n.submit-btn { background: #2A5CAA; color: white; border: none; padding: 12px 30px; border-radius: 4px; cursor: pointer; font-size: 16px; width: 100%; margin-top: 10px; }\n.submit-btn:hover { opacity: 0.9; }\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}