{"ast":null,"code":"import { ref, reactive } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { login } from '@/api/user';\nexport default {\n  name: 'Login',\n  setup() {\n    const router = useRouter();\n    const loading = ref(false);\n\n    // ÁôªÂΩïË°®ÂçïÊï∞ÊçÆ\n    const loginForm = reactive({\n      username: '',\n      password: '',\n      rememberMe: false\n    });\n\n    // ÁôªÂΩïÂ§ÑÁêÜÈÄªËæë\n    const handleLogin = async () => {\n      if (!loginForm.username || !loginForm.password) {\n        alert('Please enter username and password');\n        return;\n      }\n      loading.value = true;\n      try {\n        // Ë∞ÉÁî®ÁôªÂΩïAPI\n        const result = await login({\n          username: loginForm.username,\n          password: loginForm.password\n        });\n        if (result.code === 1 && result.data) {\n          // ÂêéÁ´ØËøîÂõûÁöÑÂ≠óÊÆµÂêçÊòØcamelCase\n          const {\n            token,\n            userId,\n            username,\n            fullName,\n            roles\n          } = result.data;\n          console.log('üîç ÁôªÂΩïÊàêÂäüÔºåÂêéÁ´ØËøîÂõûÁöÑÊï∞ÊçÆ:', result.data);\n\n          // ‰øùÂ≠òtokenÂíåÁî®Êà∑‰ø°ÊÅØ\n          localStorage.setItem('token', token);\n          const userInfoToSave = {\n            user_id: userId,\n            // ËΩ¨Êç¢Â≠óÊÆµÂêç\n            username,\n            full_name: fullName,\n            // ËΩ¨Êç¢Â≠óÊÆµÂêç\n            roles,\n            token\n          };\n          console.log('üíæ ‰øùÂ≠òÂà∞localStorageÁöÑÁî®Êà∑‰ø°ÊÅØ:', userInfoToSave);\n          localStorage.setItem('userInfo', JSON.stringify(userInfoToSave));\n\n          // Ê†πÊçÆrolesÂà§Êñ≠ËßíËâ≤Âπ∂Ë∑≥ËΩ¨\n          const roleKeys = roles || [];\n          console.log('ÂΩìÂâçÁî®Êà∑ËßíËâ≤:', roleKeys); // Âª∫ËÆÆÂä†‰∏äËøôË°åÊó•ÂøóÔºåÊñπ‰æøÊåâF12ÁúãÁúãÂà∞Â∫ïËøîÂõû‰∫ÜÂï•\n\n          let redirectPath = '/student/home'; // ÈªòËÆ§Ë∑≥ËΩ¨\n\n          // 1. ‰ºòÂÖàÁ≤æÁ°ÆÂåπÈÖç admin\n          if (roleKeys.includes('super_admin')) {\n            redirectPath = '/admin/home';\n          }\n          // 2. ÂÖ∂Ê¨°ÂåπÈÖç teacher\n          else if (roleKeys.includes('teacher')) {\n            redirectPath = '/teacher/home';\n          }\n          // 3. ÂÖ∂‰ªñÊÉÖÂÜµÔºàÂåÖÊã¨ studentÔºâÈÉΩÂéªÂ≠¶ÁîüÈ¶ñÈ°µ\n          else {\n            redirectPath = '/student/home';\n          }\n          router.push(redirectPath);\n        } else {\n          alert(result.msg || 'Login failed, please check username and password');\n        }\n      } catch (error) {\n        console.error('ÁôªÂΩïÈîôËØØ:', error);\n        alert(error.message || 'Login failed, please try again later');\n      } finally {\n        loading.value = false;\n      }\n    };\n    const handleForgotPassword = () => {\n      alert('Please contact administrator to reset password');\n    };\n    return {\n      loginForm,\n      loading,\n      handleLogin,\n      handleForgotPassword\n    };\n  }\n};","map":{"version":3,"names":["ref","reactive","useRouter","login","name","setup","router","loading","loginForm","username","password","rememberMe","handleLogin","alert","value","result","code","data","token","userId","fullName","roles","console","log","localStorage","setItem","userInfoToSave","user_id","full_name","JSON","stringify","roleKeys","redirectPath","includes","push","msg","error","message","handleForgotPassword"],"sources":["/Users/zhouzhou/Downloads/fronted-fronted_new/883Fronted_Final/src/views/Login.vue"],"sourcesContent":["<template>\n    <div class=\"login-container\">\n        <div class=\"login-content\">\n            <div class=\"login-left\">\n                <div class=\"campus-image\">\n                    <img src=\"@/assets/images/login_left_image.jpg\" alt=\"Campus Image\" class=\"cover-img\">\n                </div>\n            </div>\n\n            <div class=\"login-right\">\n                <div class=\"login-form-wrapper\">\n                    <div class=\"login-header\">\n                        <h1>Welcome to Smart Campus</h1>\n                        <p>Smart Campus Management System</p>\n                    </div>\n\n                    <form @submit.prevent=\"handleLogin\">\n                        <div class=\"form-group\">\n                            <label for=\"username\">Student ID / Employee ID</label>\n                            <input type=\"text\" id=\"username\" v-model=\"loginForm.username\" placeholder=\"Please enter student ID or employee ID\"\n                                class=\"form-input\" required>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label for=\"password\">Password</label>\n                            <input type=\"password\" id=\"password\" v-model=\"loginForm.password\" placeholder=\"Please enter password\"\n                                class=\"form-input\" required>\n                        </div>\n\n                        <div class=\"form-options\">\n                            <label class=\"checkbox-label\">\n                                <input type=\"checkbox\" v-model=\"loginForm.rememberMe\">\n                                Remember Me\n                            </label>\n                            <a href=\"#\" class=\"forgot-password\" @click.prevent=\"handleForgotPassword\">Forgot Password?</a>\n                        </div>\n\n                        <button type=\"submit\" class=\"login-btn\" :disabled=\"loading\">\n                            {{ loading ? 'Logging in...' : 'Login' }}\n                        </button>\n                    </form>\n\n                    <div class=\"account-help\">\n                        <p>üìã <strong>Account Information</strong></p>\n                        <p>‚Ä¢ Student Account: Student ID (e.g., 2021001001)</p>\n                        <p>‚Ä¢ Teacher Account: Employee ID (starts with T, e.g., T2025001)</p>\n                        <p>‚Ä¢ Admin Account: admin</p>\n                        <p>‚Ä¢ Initial Password: 123456</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { ref, reactive } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { login } from '@/api/user'\n\nexport default {\n    name: 'Login',\n    setup() {\n        const router = useRouter()\n        const loading = ref(false)\n\n        // ÁôªÂΩïË°®ÂçïÊï∞ÊçÆ\n        const loginForm = reactive({\n            username: '',\n            password: '',\n            rememberMe: false\n        })\n\n        // ÁôªÂΩïÂ§ÑÁêÜÈÄªËæë\n        const handleLogin = async () => {\n            if (!loginForm.username || !loginForm.password) {\n                alert('Please enter username and password')\n                return\n            }\n\n            loading.value = true\n\n            try {\n                // Ë∞ÉÁî®ÁôªÂΩïAPI\n                const result = await login({\n                    username: loginForm.username,\n                    password: loginForm.password\n                })\n\n                if (result.code === 1 && result.data) {\n                    // ÂêéÁ´ØËøîÂõûÁöÑÂ≠óÊÆµÂêçÊòØcamelCase\n                    const { token, userId, username, fullName, roles } = result.data\n\n                    console.log('üîç ÁôªÂΩïÊàêÂäüÔºåÂêéÁ´ØËøîÂõûÁöÑÊï∞ÊçÆ:', result.data)\n\n                    // ‰øùÂ≠òtokenÂíåÁî®Êà∑‰ø°ÊÅØ\n                    localStorage.setItem('token', token)\n                    const userInfoToSave = {\n                        user_id: userId,           // ËΩ¨Êç¢Â≠óÊÆµÂêç\n                        username,\n                        full_name: fullName,       // ËΩ¨Êç¢Â≠óÊÆµÂêç\n                        roles,\n                        token\n                    }\n                    console.log('üíæ ‰øùÂ≠òÂà∞localStorageÁöÑÁî®Êà∑‰ø°ÊÅØ:', userInfoToSave)\n                    localStorage.setItem('userInfo', JSON.stringify(userInfoToSave))\n\n                  // Ê†πÊçÆrolesÂà§Êñ≠ËßíËâ≤Âπ∂Ë∑≥ËΩ¨\n                  const roleKeys = roles || []\n                  console.log('ÂΩìÂâçÁî®Êà∑ËßíËâ≤:', roleKeys) // Âª∫ËÆÆÂä†‰∏äËøôË°åÊó•ÂøóÔºåÊñπ‰æøÊåâF12ÁúãÁúãÂà∞Â∫ïËøîÂõû‰∫ÜÂï•\n\n                  let redirectPath = '/student/home' // ÈªòËÆ§Ë∑≥ËΩ¨\n\n                  // 1. ‰ºòÂÖàÁ≤æÁ°ÆÂåπÈÖç admin\n                  if (roleKeys.includes('super_admin')) {\n                    redirectPath = '/admin/home'\n                  }\n                  // 2. ÂÖ∂Ê¨°ÂåπÈÖç teacher\n                  else if (roleKeys.includes('teacher')) {\n                    redirectPath = '/teacher/home'\n                  }\n                  // 3. ÂÖ∂‰ªñÊÉÖÂÜµÔºàÂåÖÊã¨ studentÔºâÈÉΩÂéªÂ≠¶ÁîüÈ¶ñÈ°µ\n                  else {\n                    redirectPath = '/student/home'\n                  }\n\n                    router.push(redirectPath)\n                } else {\n                    alert(result.msg || 'Login failed, please check username and password')\n                }\n            } catch (error) {\n                console.error('ÁôªÂΩïÈîôËØØ:', error)\n                alert(error.message || 'Login failed, please try again later')\n            } finally {\n                loading.value = false\n            }\n        }\n\n        const handleForgotPassword = () => {\n            alert('Please contact administrator to reset password')\n        }\n\n        return {\n            loginForm,\n            loading,\n            handleLogin,\n            handleForgotPassword\n        }\n    }\n}\n</script>\n\n<style scoped>\n.login-container {\n    min-block-size: 100vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: #f0f2f5;\n}\n\n.login-content {\n    display: flex;\n    inline-size: 85%;\n    max-inline-size: 1000px;\n    block-size: 600px;\n    background: white;\n    border-radius: 16px;\n    overflow: hidden;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);\n}\n\n/* Â∑¶‰æßÂõæÁâáÂå∫ */\n.login-left {\n    flex: 1.2;\n    background: #f8f9fa;\n    position: relative;\n    overflow: hidden;\n}\n\n.campus-image {\n    inline-size: 100%;\n    block-size: 100%;\n}\n\n.cover-img {\n    inline-size: 100%;\n    block-size: 100%;\n    object-fit: cover;\n    display: block;\n}\n\n/* Âè≥‰æßË°®ÂçïÂå∫ */\n.login-right {\n    flex: 1;\n    padding: 40px;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    background: white;\n}\n\n.login-form-wrapper {\n    inline-size: 100%;\n    max-inline-size: 360px;\n    margin: 0 auto;\n}\n\n.login-header {\n    text-align: center;\n    margin-block-end: 30px;\n}\n\n.login-header h1 {\n    color: #2c3e50;\n    font-size: 26px;\n    font-weight: 600;\n    margin-block-end: 8px;\n}\n\n.login-header p {\n    color: #7f8c8d;\n    font-size: 14px;\n}\n\n.form-group {\n    margin-block-end: 20px;\n}\n\n.form-group label {\n    display: block;\n    margin-block-end: 8px;\n    font-weight: 500;\n    color: #2d3748;\n    font-size: 14px;\n}\n\n.form-input {\n    inline-size: 100%;\n    padding: 12px 16px;\n    border: 1px solid #e2e8f0;\n    border-radius: 8px;\n    font-size: 14px;\n    transition: all 0.3s ease;\n    background: #fafafa;\n    box-sizing: border-box;\n}\n\n.form-input:focus {\n    outline: none;\n    border-color: #2A5CAA;\n    box-shadow: 0 0 0 3px rgba(42, 92, 170, 0.1);\n    background: #fff;\n}\n\n.form-options {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-block-end: 25px;\n    font-size: 14px;\n}\n\n.checkbox-label {\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n    color: #5a6c7d;\n}\n\n.checkbox-label input {\n    margin-inline-end: 8px;\n}\n\n.forgot-password {\n    color: #2A5CAA;\n    text-decoration: none;\n    transition: color 0.2s;\n}\n\n.forgot-password:hover {\n    color: #1e4b8b;\n    text-decoration: underline;\n}\n\n.login-btn {\n    inline-size: 100%;\n    padding: 12px;\n    background: #2A5CAA;\n    color: white;\n    border: none;\n    border-radius: 8px;\n    font-size: 16px;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    margin-block-end: 20px;\n}\n\n.login-btn:hover {\n    background: #1e4b8b;\n    transform: translateY(-1px);\n    box-shadow: 0 4px 12px rgba(42, 92, 170, 0.3);\n}\n\n.login-btn:disabled {\n    background: #a0aec0;\n    cursor: not-allowed;\n}\n\n/* Account InformationÂå∫Âüü */\n.account-help {\n    font-size: 12px;\n    color: #7f8c8d;\n    margin-block-start: 20px;\n    line-height: 1.6;\n    padding: 15px;\n    background-color: #f8f9fa;\n    border-radius: 8px;\n    border: 1px solid #eee;\n}\n\n.account-help p {\n    margin: 4px 0;\n}\n\n.account-help strong {\n    color: #2c3e50;\n}\n\n/* ÂìçÂ∫îÂºèËÆæËÆ° */\n@media (max-width: 768px) {\n    .login-content {\n        flex-direction: column;\n        block-size: auto;\n        inline-size: 90%;\n        margin: 20px 0;\n    }\n\n    .login-left {\n        block-size: 200px;\n        flex: none;\n    }\n\n    .login-right {\n        padding: 30px 20px;\n    }\n}\n</style>"],"mappings":"AAwDA,SAASA,GAAG,EAAEC,QAAO,QAAS,KAAI;AAClC,SAASC,SAAQ,QAAS,YAAW;AACrC,SAASC,KAAI,QAAS,YAAW;AAEjC,eAAe;EACXC,IAAI,EAAE,OAAO;EACbC,KAAKA,CAAA,EAAG;IACJ,MAAMC,MAAK,GAAIJ,SAAS,CAAC;IACzB,MAAMK,OAAM,GAAIP,GAAG,CAAC,KAAK;;IAEzB;IACA,MAAMQ,SAAQ,GAAIP,QAAQ,CAAC;MACvBQ,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE,EAAE;MACZC,UAAU,EAAE;IAChB,CAAC;;IAED;IACA,MAAMC,WAAU,GAAI,MAAAA,CAAA,KAAY;MAC5B,IAAI,CAACJ,SAAS,CAACC,QAAO,IAAK,CAACD,SAAS,CAACE,QAAQ,EAAE;QAC5CG,KAAK,CAAC,oCAAoC;QAC1C;MACJ;MAEAN,OAAO,CAACO,KAAI,GAAI,IAAG;MAEnB,IAAI;QACA;QACA,MAAMC,MAAK,GAAI,MAAMZ,KAAK,CAAC;UACvBM,QAAQ,EAAED,SAAS,CAACC,QAAQ;UAC5BC,QAAQ,EAAEF,SAAS,CAACE;QACxB,CAAC;QAED,IAAIK,MAAM,CAACC,IAAG,KAAM,KAAKD,MAAM,CAACE,IAAI,EAAE;UAClC;UACA,MAAM;YAAEC,KAAK;YAAEC,MAAM;YAAEV,QAAQ;YAAEW,QAAQ;YAAEC;UAAM,IAAIN,MAAM,CAACE,IAAG;UAE/DK,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAER,MAAM,CAACE,IAAI;;UAE3C;UACAO,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEP,KAAK;UACnC,MAAMQ,cAAa,GAAI;YACnBC,OAAO,EAAER,MAAM;YAAY;YAC3BV,QAAQ;YACRmB,SAAS,EAAER,QAAQ;YAAQ;YAC3BC,KAAK;YACLH;UACJ;UACAI,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAEG,cAAc;UACtDF,YAAY,CAACC,OAAO,CAAC,UAAU,EAAEI,IAAI,CAACC,SAAS,CAACJ,cAAc,CAAC;;UAEjE;UACA,MAAMK,QAAO,GAAIV,KAAI,IAAK,EAAC;UAC3BC,OAAO,CAACC,GAAG,CAAC,SAAS,EAAEQ,QAAQ,GAAE;;UAEjC,IAAIC,YAAW,GAAI,eAAc,EAAE;;UAEnC;UACA,IAAID,QAAQ,CAACE,QAAQ,CAAC,aAAa,CAAC,EAAE;YACpCD,YAAW,GAAI,aAAY;UAC7B;UACA;UAAA,KACK,IAAID,QAAQ,CAACE,QAAQ,CAAC,SAAS,CAAC,EAAE;YACrCD,YAAW,GAAI,eAAc;UAC/B;UACA;UAAA,KACK;YACHA,YAAW,GAAI,eAAc;UAC/B;UAEE1B,MAAM,CAAC4B,IAAI,CAACF,YAAY;QAC5B,OAAO;UACHnB,KAAK,CAACE,MAAM,CAACoB,GAAE,IAAK,kDAAkD;QAC1E;MACJ,EAAE,OAAOC,KAAK,EAAE;QACZd,OAAO,CAACc,KAAK,CAAC,OAAO,EAAEA,KAAK;QAC5BvB,KAAK,CAACuB,KAAK,CAACC,OAAM,IAAK,sCAAsC;MACjE,UAAU;QACN9B,OAAO,CAACO,KAAI,GAAI,KAAI;MACxB;IACJ;IAEA,MAAMwB,oBAAmB,GAAIA,CAAA,KAAM;MAC/BzB,KAAK,CAAC,gDAAgD;IAC1D;IAEA,OAAO;MACHL,SAAS;MACTD,OAAO;MACPK,WAAW;MACX0B;IACJ;EACJ;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}