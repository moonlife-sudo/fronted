{"ast":null,"code":"import { getProfile, updateProfile } from '@/api/user';\nexport default {\n  name: 'TeacherProfile',\n  data() {\n    return {\n      activeSection: 'basic-info',\n      isEditing: false,\n      loading: false,\n      viewMode: 'grid',\n      selectedTimeRange: 'week',\n      selectedTheme: 'blue',\n      selectedFontSize: 'medium',\n      originalUserInfo: null,\n      // 保存原始数据用于取消编辑\n      userInfo: {\n        full_name: '',\n        username: '',\n        college: 'JI',\n        department: 'COMPUTER SCIENCE',\n        email: '',\n        role: 'Teacher'\n      },\n      navItems: [{\n        id: 'basic-info',\n        text: 'Basic Info',\n        icon: 'bi bi-person-fill'\n      }, {\n        id: 'account-security',\n        text: 'Account Security',\n        icon: 'bi bi-shield-lock-fill'\n      }, {\n        id: 'notifications',\n        text: 'Notifications',\n        icon: 'bi bi-bell-fill'\n      }, {\n        id: 'settings',\n        text: 'Settings',\n        icon: 'bi bi-gear-fill'\n      }],\n      notifications: [{\n        id: 1,\n        title: 'System Notice: New Semester Course Selection',\n        content: 'The new semester course selection system will open on September 1, 2023. Please prepare in advance...',\n        time: '2023-08-25 10:30',\n        icon: 'bi bi-megaphone-fill',\n        unread: true\n      }, {\n        id: 2,\n        title: 'Course Reminder: Computer Organization',\n        content: 'Your Computer Organization class will be held tomorrow at 8:00 AM in Classroom 301, Building 3...',\n        time: '2023-08-24 15:45',\n        icon: 'bi bi-calendar-event-fill',\n        unread: false\n      }, {\n        id: 3,\n        title: 'Assignment Reminder: Data Structures Homework',\n        content: 'The second Data Structures assignment has been published. Deadline: September 5, 2023...',\n        time: '2023-08-23 09:20',\n        icon: 'bi bi-book-fill',\n        unread: false\n      }],\n      notificationSettings: [{\n        id: 1,\n        name: 'Course Reminders',\n        description: 'Remind me before class starts',\n        enabled: true\n      }, {\n        id: 2,\n        name: 'Assignment Deadlines',\n        description: 'Remind me before assignment deadlines',\n        enabled: true\n      }, {\n        id: 3,\n        name: 'System Notifications',\n        description: 'Receive system announcements and notifications',\n        enabled: true\n      }],\n      privacySettings: [{\n        id: 1,\n        name: 'Public Profile',\n        description: 'Allow other students to view my basic information',\n        enabled: false\n      }],\n      themeColors: ['blue', 'green', 'purple']\n    };\n  },\n  computed: {\n    maskedEmail() {\n      return this.userInfo.email ? this.userInfo.email.replace(/(.{2}).*@(.*)/, '$1****@$2') : 'Not Bound';\n    },\n    filteredActivities() {\n      // 根据选择的时间范围过滤活动\n      // 这里简化处理，实际项目中需要根据日期计算\n      return this.activities;\n    }\n  },\n  methods: {\n    // 获取头像图片\n    getAvatarImage() {\n      // 教师页面直接返回教师头像\n      return require('@/assets/images/avatar-teacher.svg');\n    },\n    switchSection(sectionId) {\n      this.activeSection = sectionId;\n    },\n    enableEdit() {\n      // 保存原始数据\n      this.originalUserInfo = JSON.parse(JSON.stringify(this.userInfo));\n      this.isEditing = true;\n    },\n    cancelEdit() {\n      this.isEditing = false;\n      // 恢复原始数据\n      if (this.originalUserInfo) {\n        this.userInfo = JSON.parse(JSON.stringify(this.originalUserInfo));\n      }\n    },\n    async saveBasicInfo() {\n      if (this.loading) return;\n\n      // 检查token是否存在\n      const token = localStorage.getItem('token');\n      if (!token) {\n        alert('Not logged in, please login first');\n        this.$router.push('/login');\n        return;\n      }\n      this.loading = true;\n      try {\n        const basicInfo = {\n          email: this.userInfo.email || null\n        };\n        const profileInfo = {\n          college: this.userInfo.college || null,\n          department: this.userInfo.department || null\n        };\n        const result = await updateProfile({\n          basicInfo,\n          profileInfo\n        });\n        if (result.code === 1) {\n          alert('个人信息已保存成功！');\n          this.isEditing = false;\n          // 重新加载用户信息\n          await this.loadUserInfo();\n        } else {\n          alert(result.msg || '保存失败，请重试');\n        }\n      } catch (error) {\n        console.error('保存失败:', error);\n        if (error.message && error.message.includes('未登录')) {\n          alert('Login expired, please login again');\n          this.$router.push('/login');\n        } else {\n          alert(error.message || 'Failed to save, please try again later');\n        }\n      } finally {\n        this.loading = false;\n      }\n    },\n    modifyPassword() {\n      alert('即将跳转到修改密码页面...');\n    },\n    modifyEmail() {\n      alert('即将跳转到更换邮箱页面...');\n    },\n    markAllAsRead() {\n      this.notifications.forEach(notification => {\n        notification.unread = false;\n      });\n      alert('所有通知已标记为已读');\n    },\n    changeViewMode(mode) {\n      this.viewMode = mode;\n    },\n    removeFavorite(id) {\n      if (confirm('Are you sure you want to remove this favorite item?')) {\n        this.favorites = this.favorites.filter(favorite => favorite.id !== id);\n      }\n    },\n    filterActivities() {\n      // 根据时间范围过滤活动\n      // 实际项目中需要实现具体的过滤逻辑\n      console.log('过滤活动，时间范围:', this.selectedTimeRange);\n    },\n    updateSetting(setting) {\n      console.log('更新设置:', setting);\n      // 实际项目中这里会发送API请求保存设置\n    },\n    changeTheme(color) {\n      this.selectedTheme = color;\n      // 实际项目中这里会应用主题颜色\n      alert(`主题颜色已切换为: ${color}`);\n    },\n    changeFontSize() {\n      // 实际项目中这里会更改字体大小\n      alert(`字体大小已更改为: ${this.selectedFontSize}`);\n    },\n    triggerAvatarUpload() {\n      // 创建文件输入元素\n      const input = document.createElement('input');\n      input.type = 'file';\n      input.accept = 'image/*';\n      input.onchange = e => {\n        const file = e.target.files[0];\n        if (file) {\n          const reader = new FileReader();\n          reader.onload = event => {\n            // 更新头像\n            document.querySelector('.avatar').src = event.target.result;\n          };\n          reader.readAsDataURL(file);\n        }\n      };\n      input.click();\n    },\n    // 加载用户信息\n    async loadUserInfo() {\n      this.loading = true;\n      try {\n        const token = localStorage.getItem('token');\n        if (!token) {\n          console.log('未找到token，尝试从localStorage获取用户信息');\n          // 尝试从localStorage获取用户信息作为后备\n          const savedUser = localStorage.getItem('userInfo');\n          if (savedUser) {\n            try {\n              const parsedUser = JSON.parse(savedUser);\n              this.userInfo = {\n                full_name: parsedUser.full_name || parsedUser.name || '',\n                username: parsedUser.username || '',\n                email: parsedUser.email || '',\n                role: parsedUser.role || 'Teacher',\n                college: 'JI',\n                department: 'COMPUTER SCIENCE'\n              };\n              console.log('从localStorage加载的教师信息:', this.userInfo);\n            } catch (parseError) {\n              console.error('解析localStorage用户信息失败:', parseError);\n            }\n          }\n          return;\n        }\n        console.log('正在从API获取教师信息...');\n        const result = await getProfile();\n        if (result.code === 1 && result.data) {\n          const data = result.data;\n          this.userInfo = {\n            full_name: data.full_name || data.name || '',\n            username: data.username || '',\n            email: data.email || '',\n            role: data.role || 'Teacher',\n            college: 'JI',\n            department: 'COMPUTER SCIENCE'\n          };\n          console.log('从API加载的教师信息:', this.userInfo);\n\n          // 同步更新localStorage\n          localStorage.setItem('userInfo', JSON.stringify(this.userInfo));\n        } else {\n          console.log('API返回无效数据，使用localStorage备用方案');\n          // API失败时使用localStorage作为后备\n          const savedUser = localStorage.getItem('userInfo');\n          if (savedUser) {\n            try {\n              const parsedUser = JSON.parse(savedUser);\n              this.userInfo = {\n                full_name: parsedUser.full_name || parsedUser.name || '',\n                username: parsedUser.username || '',\n                email: parsedUser.email || '',\n                role: parsedUser.role || '教师',\n                college: 'JI',\n                department: 'COMPUTER SCIENCE'\n              };\n            } catch (parseError) {\n              console.error('解析localStorage用户信息失败:', parseError);\n            }\n          }\n        }\n      } catch (error) {\n        console.error('加载教师信息失败:', error);\n        // API失败时使用localStorage作为后备\n        const savedUser = localStorage.getItem('userInfo');\n        if (savedUser) {\n          try {\n            const parsedUser = JSON.parse(savedUser);\n            this.userInfo = {\n              full_name: parsedUser.full_name || parsedUser.name || '',\n              username: parsedUser.username || '',\n              email: parsedUser.email || '',\n              role: parsedUser.role || '教师',\n              college: 'JI',\n              department: 'COMPUTER SCIENCE'\n            };\n            console.log('错误回退：从localStorage加载的教师信息:', this.userInfo);\n          } catch (parseError) {\n            console.error('解析localStorage用户信息失败:', parseError);\n          }\n        }\n      } finally {\n        this.loading = false;\n      }\n    }\n  },\n  async mounted() {\n    console.log('教师个人中心页面已加载');\n    await this.loadUserInfo();\n  }\n};","map":{"version":3,"names":["getProfile","updateProfile","name","data","activeSection","isEditing","loading","viewMode","selectedTimeRange","selectedTheme","selectedFontSize","originalUserInfo","userInfo","full_name","username","college","department","email","role","navItems","id","text","icon","notifications","title","content","time","unread","notificationSettings","description","enabled","privacySettings","themeColors","computed","maskedEmail","replace","filteredActivities","activities","methods","getAvatarImage","require","switchSection","sectionId","enableEdit","JSON","parse","stringify","cancelEdit","saveBasicInfo","token","localStorage","getItem","alert","$router","push","basicInfo","profileInfo","result","code","loadUserInfo","msg","error","console","message","includes","modifyPassword","modifyEmail","markAllAsRead","forEach","notification","changeViewMode","mode","removeFavorite","confirm","favorites","filter","favorite","filterActivities","log","updateSetting","setting","changeTheme","color","changeFontSize","triggerAvatarUpload","input","document","createElement","type","accept","onchange","e","file","target","files","reader","FileReader","onload","event","querySelector","src","readAsDataURL","click","savedUser","parsedUser","parseError","setItem","mounted"],"sources":["/Users/zhouzhou/Downloads/fronted-fronted_new/883Fronted_English/src/views/Teacher/TeacherProfile.vue"],"sourcesContent":["<template>\n  <div class=\"profile-container\">\n    <div class=\"profile-sidebar\">\n      <div class=\"user-card\">\n        <div class=\"avatar-container\">\n          <img \n            loading=\"lazy\" \n            :src=\"getAvatarImage()\" \n            alt=\"User Avatar\" \n            class=\"avatar\"\n          >\n          <button class=\"avatar-upload\" @click=\"triggerAvatarUpload\">\n            <i class=\"bi bi-camera-fill\"></i>\n          </button>\n        </div>\n        <h3 class=\"username\">{{ userInfo.full_name || userInfo.username || userInfo.name || '加载中...' }}</h3>\n        <p class=\"user-role\">{{ userInfo.role }} | {{ userInfo.college }}</p>\n      </div>\n      \n      <nav class=\"profile-nav\">\n        <ul>\n          <li \n            v-for=\"nav in navItems\" \n            :key=\"nav.id\"\n            :class=\"{ active: activeSection === nav.id }\"\n          >\n            <a href=\"#\" @click.prevent=\"switchSection(nav.id)\">\n              <i :class=\"nav.icon\"></i> {{ nav.text }}\n            </a>\n          </li>\n        </ul>\n      </nav>\n    </div>\n    \n    <div class=\"profile-content\">\n      <!-- 基本信息 -->\n      <section id=\"basic-info\" class=\"content-section\" :class=\"{ active: activeSection === 'basic-info' }\">\n        <div class=\"section-header\">\n          <h2>Basic Information</h2>\n          <button class=\"edit-btn\" @click=\"enableEdit\" v-if=\"!isEditing\">\n            <i class=\"bi bi-pencil-fill\"></i> Edit\n          </button>\n        </div>\n        \n        <form class=\"info-form\" @submit.prevent=\"saveBasicInfo\">\n          <div class=\"form-group\">\n            <label for=\"name\">Name</label>\n            <input \n              type=\"text\" \n              id=\"name\"\n              :value=\"userInfo.full_name || userInfo.username\"\n              @input=\"userInfo.full_name = $event.target.value\"\n              :readonly=\"!isEditing\"\n            >\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"teacher-id\">Teacher ID</label>\n            <input \n              type=\"text\" \n              id=\"teacher-id\" \n              v-model=\"userInfo.username\" \n              readonly\n            >\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"college\">College</label>\n            <input \n              type=\"text\" \n              id=\"college\" \n              v-model=\"userInfo.college\" \n              :readonly=\"!isEditing\"\n              placeholder=\"Please enter college\"\n            >\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"department\">Department</label>\n            <input \n              type=\"text\" \n              id=\"department\" \n              v-model=\"userInfo.department\" \n              :readonly=\"!isEditing\"\n              placeholder=\"Please enter department\"\n            >\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"email\">Email</label>\n            <input \n              type=\"email\" \n              id=\"email\" \n              v-model=\"userInfo.email\" \n              :readonly=\"!isEditing\"\n              placeholder=\"Please enter email address\"\n            >\n          </div>\n          \n          <div class=\"form-actions\" v-if=\"isEditing\">\n            <button type=\"button\" class=\"cancel-btn\" @click=\"cancelEdit\" :disabled=\"loading\">Cancel</button>\n            <button type=\"submit\" class=\"save-btn\" :disabled=\"loading\">\n              {{ loading ? 'Saving...' : 'Save' }}\n            </button>\n          </div>\n        </form>\n      </section>\n      \n      <!-- 账号安全 -->\n      <section id=\"account-security\" class=\"content-section\" :class=\"{ active: activeSection === 'account-security' }\">\n        <div class=\"section-header\">\n          <h2>Account Security</h2>\n        </div>\n        \n        <div class=\"security-item\">\n          <div class=\"security-info\">\n            <i class=\"bi bi-shield-lock-fill\"></i>\n            <div>\n              <h3>Login Password</h3>\n              <p>Change your password regularly to ensure account security</p>\n            </div>\n          </div>\n          <button class=\"modify-btn\" @click=\"modifyPassword\">Change Password</button>\n        </div>\n        \n        <div class=\"security-item\">\n          <div class=\"security-info\">\n            <i class=\"bi bi-envelope-fill\"></i>\n            <div>\n              <h3>Email Binding</h3>\n              <p>Bound email: {{ maskedEmail }}</p>\n            </div>\n          </div>\n          <button class=\"modify-btn\" @click=\"modifyEmail\">Change Email</button>\n        </div>\n        \n        <div class=\"security-tips\">\n          <i class=\"bi bi-info-circle-fill\"></i>\n          <p>To protect your account security, it is recommended to change your password regularly and bind your email</p>\n        </div>\n      </section>\n      \n      <!-- 消息通知 -->\n      <section id=\"notifications\" class=\"content-section\" :class=\"{ active: activeSection === 'notifications' }\">\n        <div class=\"section-header\">\n          <h2>Notifications</h2>\n          <button class=\"mark-all-read\" @click=\"markAllAsRead\">Mark All as Read</button>\n        </div>\n        \n        <div class=\"notification-list\">\n          <div \n            v-for=\"notification in notifications\" \n            :key=\"notification.id\"\n            class=\"notification-item\" \n            :class=\"{ unread: notification.unread }\"\n          >\n            <div class=\"notification-icon\">\n              <i :class=\"notification.icon\"></i>\n            </div>\n            <div class=\"notification-content\">\n              <h3>{{ notification.title }}</h3>\n              <p>{{ notification.content }}</p>\n              <span class=\"notification-time\">{{ notification.time }}</span>\n            </div>\n          </div>\n        </div>\n      </section>\n      \n      <!-- 系统设置 -->\n      <section id=\"settings\" class=\"content-section\" :class=\"{ active: activeSection === 'settings' }\">\n        \n        <div class=\"settings-group\">\n          <h3>Notification Settings</h3>\n          <div \n            v-for=\"setting in notificationSettings\" \n            :key=\"setting.id\"\n            class=\"setting-item\"\n          >\n            <div class=\"setting-info\">\n              <h4>{{ setting.name }}</h4>\n              <p>{{ setting.description }}</p>\n            </div>\n            <label class=\"switch\">\n              <input \n                type=\"checkbox\" \n                v-model=\"setting.enabled\"\n                @change=\"updateSetting(setting)\"\n              >\n              <span class=\"slider\"></span>\n            </label>\n          </div>\n        </div>\n        \n        <div class=\"settings-group\">\n          <h3>Privacy Settings</h3>\n          <div \n            v-for=\"setting in privacySettings\" \n            :key=\"setting.id\"\n            class=\"setting-item\"\n          >\n            <div class=\"setting-info\">\n              <h4>{{ setting.name }}</h4>\n              <p>{{ setting.description }}</p>\n            </div>\n            <label class=\"switch\">\n              <input \n                type=\"checkbox\" \n                v-model=\"setting.enabled\"\n                @change=\"updateSetting(setting)\"\n              >\n              <span class=\"slider\"></span>\n            </label>\n          </div>\n        </div>\n        \n      </section>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { getProfile, updateProfile } from '@/api/user'\n\nexport default {\n  name: 'TeacherProfile',\n  data() {\n    return {\n      activeSection: 'basic-info',\n      isEditing: false,\n      loading: false,\n      viewMode: 'grid',\n      selectedTimeRange: 'week',\n      selectedTheme: 'blue',\n      selectedFontSize: 'medium',\n      originalUserInfo: null, // 保存原始数据用于取消编辑\n      userInfo: {\n        full_name: '',\n        username: '',\n        college: 'JI',\n        department: 'COMPUTER SCIENCE',\n        email: '',\n        role: 'Teacher',\n      },\n      navItems: [\n        { id: 'basic-info', text: 'Basic Info', icon: 'bi bi-person-fill' },\n        { id: 'account-security', text: 'Account Security', icon: 'bi bi-shield-lock-fill' },\n        { id: 'notifications', text: 'Notifications', icon: 'bi bi-bell-fill' },\n        { id: 'settings', text: 'Settings', icon: 'bi bi-gear-fill' }\n      ],\n      notifications: [\n        {\n          id: 1,\n          title: 'System Notice: New Semester Course Selection',\n          content: 'The new semester course selection system will open on September 1, 2023. Please prepare in advance...',\n          time: '2023-08-25 10:30',\n          icon: 'bi bi-megaphone-fill',\n          unread: true\n        },\n        {\n          id: 2,\n          title: 'Course Reminder: Computer Organization',\n          content: 'Your Computer Organization class will be held tomorrow at 8:00 AM in Classroom 301, Building 3...',\n          time: '2023-08-24 15:45',\n          icon: 'bi bi-calendar-event-fill',\n          unread: false\n        },\n        {\n          id: 3,\n          title: 'Assignment Reminder: Data Structures Homework',\n          content: 'The second Data Structures assignment has been published. Deadline: September 5, 2023...',\n          time: '2023-08-23 09:20',\n          icon: 'bi bi-book-fill',\n          unread: false\n        }\n      ],\n      \n      notificationSettings: [\n        {\n          id: 1,\n          name: 'Course Reminders',\n          description: 'Remind me before class starts',\n          enabled: true\n        },\n        {\n          id: 2,\n          name: 'Assignment Deadlines',\n          description: 'Remind me before assignment deadlines',\n          enabled: true\n        },\n        {\n          id: 3,\n          name: 'System Notifications',\n          description: 'Receive system announcements and notifications',\n          enabled: true\n        }\n      ],\n      privacySettings: [\n        {\n          id: 1,\n          name: 'Public Profile',\n          description: 'Allow other students to view my basic information',\n          enabled: false\n        },\n      ],\n      themeColors: ['blue', 'green', 'purple']\n    }\n  },\n  computed: {\n    maskedEmail() {\n      return this.userInfo.email ? this.userInfo.email.replace(/(.{2}).*@(.*)/, '$1****@$2') : 'Not Bound'\n    },\n    filteredActivities() {\n      // 根据选择的时间范围过滤活动\n      // 这里简化处理，实际项目中需要根据日期计算\n      return this.activities\n    }\n  },\n  methods: {\n    // 获取头像图片\n    getAvatarImage() {\n      // 教师页面直接返回教师头像\n      return require('@/assets/images/avatar-teacher.svg')\n    },\n    switchSection(sectionId) {\n      this.activeSection = sectionId\n    },\n    enableEdit() {\n      // 保存原始数据\n      this.originalUserInfo = JSON.parse(JSON.stringify(this.userInfo))\n      this.isEditing = true\n    },\n    cancelEdit() {\n      this.isEditing = false\n      // 恢复原始数据\n      if (this.originalUserInfo) {\n        this.userInfo = JSON.parse(JSON.stringify(this.originalUserInfo))\n      }\n    },\n    async saveBasicInfo() {\n      if (this.loading) return\n      \n      // 检查token是否存在\n      const token = localStorage.getItem('token')\n      if (!token) {\n        alert('Not logged in, please login first')\n        this.$router.push('/login')\n        return\n      }\n      \n      this.loading = true\n      try {\n        const basicInfo = {\n          email: this.userInfo.email || null\n        }\n        \n        const profileInfo = {\n          college: this.userInfo.college || null,\n          department: this.userInfo.department || null\n        }\n        \n        const result = await updateProfile({\n          basicInfo,\n          profileInfo\n        })\n        \n        if (result.code === 1) {\n          alert('个人信息已保存成功！')\n          this.isEditing = false\n          // 重新加载用户信息\n          await this.loadUserInfo()\n        } else {\n          alert(result.msg || '保存失败，请重试')\n        }\n      } catch (error) {\n        console.error('保存失败:', error)\n        if (error.message && error.message.includes('未登录')) {\n          alert('Login expired, please login again')\n          this.$router.push('/login')\n        } else {\n          alert(error.message || 'Failed to save, please try again later')\n        }\n      } finally {\n        this.loading = false\n      }\n    },\n    modifyPassword() {\n      alert('即将跳转到修改密码页面...')\n    },\n    modifyEmail() {\n      alert('即将跳转到更换邮箱页面...')\n    },\n    markAllAsRead() {\n      this.notifications.forEach(notification => {\n        notification.unread = false\n      })\n      alert('所有通知已标记为已读')\n    },\n    changeViewMode(mode) {\n      this.viewMode = mode\n    },\n    removeFavorite(id) {\n      if (confirm('Are you sure you want to remove this favorite item?')) {\n        this.favorites = this.favorites.filter(favorite => favorite.id !== id)\n      }\n    },\n    filterActivities() {\n      // 根据时间范围过滤活动\n      // 实际项目中需要实现具体的过滤逻辑\n      console.log('过滤活动，时间范围:', this.selectedTimeRange)\n    },\n    updateSetting(setting) {\n      console.log('更新设置:', setting)\n      // 实际项目中这里会发送API请求保存设置\n    },\n    changeTheme(color) {\n      this.selectedTheme = color\n      // 实际项目中这里会应用主题颜色\n      alert(`主题颜色已切换为: ${color}`)\n    },\n    changeFontSize() {\n      // 实际项目中这里会更改字体大小\n      alert(`字体大小已更改为: ${this.selectedFontSize}`)\n    },\n    triggerAvatarUpload() {\n      // 创建文件输入元素\n      const input = document.createElement('input')\n      input.type = 'file'\n      input.accept = 'image/*'\n      input.onchange = (e) => {\n        const file = e.target.files[0]\n        if (file) {\n          const reader = new FileReader()\n          reader.onload = (event) => {\n            // 更新头像\n            document.querySelector('.avatar').src = event.target.result\n          }\n          reader.readAsDataURL(file)\n        }\n      }\n      input.click()\n    },\n    \n    // 加载用户信息\n    async loadUserInfo() {\n      this.loading = true\n      try {\n        const token = localStorage.getItem('token')\n        if (!token) {\n          console.log('未找到token，尝试从localStorage获取用户信息')\n          // 尝试从localStorage获取用户信息作为后备\n          const savedUser = localStorage.getItem('userInfo')\n          if (savedUser) {\n            try {\n              const parsedUser = JSON.parse(savedUser)\n              this.userInfo = {\n                full_name: parsedUser.full_name || parsedUser.name || '',\n                username: parsedUser.username || '',\n                email: parsedUser.email || '',\n                role: parsedUser.role || 'Teacher',\n                college: 'JI',\n                department: 'COMPUTER SCIENCE',\n              }\n              console.log('从localStorage加载的教师信息:', this.userInfo)\n            } catch (parseError) {\n              console.error('解析localStorage用户信息失败:', parseError)\n            }\n          }\n          return\n        }\n\n        console.log('正在从API获取教师信息...')\n        const result = await getProfile()\n        \n        if (result.code === 1 && result.data) {\n          const data = result.data\n          this.userInfo = {\n            full_name: data.full_name || data.name || '',\n            username: data.username || '',\n            email: data.email || '',\n            role: data.role || 'Teacher',\n            college: 'JI',\n            department: 'COMPUTER SCIENCE',\n          }\n          console.log('从API加载的教师信息:', this.userInfo)\n          \n          // 同步更新localStorage\n          localStorage.setItem('userInfo', JSON.stringify(this.userInfo))\n        } else {\n          console.log('API返回无效数据，使用localStorage备用方案')\n          // API失败时使用localStorage作为后备\n          const savedUser = localStorage.getItem('userInfo')\n          if (savedUser) {\n            try {\n              const parsedUser = JSON.parse(savedUser)\n              this.userInfo = {\n                full_name: parsedUser.full_name || parsedUser.name || '',\n                username: parsedUser.username || '',\n                email: parsedUser.email || '',\n                role: parsedUser.role || '教师',\n                college: 'JI',\n                department: 'COMPUTER SCIENCE',\n              }\n            } catch (parseError) {\n              console.error('解析localStorage用户信息失败:', parseError)\n            }\n          }\n        }\n      } catch (error) {\n        console.error('加载教师信息失败:', error)\n        // API失败时使用localStorage作为后备\n        const savedUser = localStorage.getItem('userInfo')\n        if (savedUser) {\n          try {\n            const parsedUser = JSON.parse(savedUser)\n            this.userInfo = {\n              full_name: parsedUser.full_name || parsedUser.name || '',\n              username: parsedUser.username || '',\n              email: parsedUser.email || '',\n              role: parsedUser.role || '教师',\n              college: 'JI',\n              department: 'COMPUTER SCIENCE',\n            }\n            console.log('错误回退：从localStorage加载的教师信息:', this.userInfo)\n          } catch (parseError) {\n            console.error('解析localStorage用户信息失败:', parseError)\n          }\n        }\n      } finally {\n        this.loading = false\n      }\n    }\n  },\n  async mounted() {\n    console.log('教师个人中心页面已加载')\n    await this.loadUserInfo()\n  }\n}\n</script>\n\n<style scoped>\n@import '@/assets/css/profile.css'; /* 或者直接引入 */\n</style>"],"mappings":"AA6NA,SAASA,UAAU,EAAEC,aAAY,QAAS,YAAW;AAErD,eAAe;EACbC,IAAI,EAAE,gBAAgB;EACtBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,aAAa,EAAE,YAAY;MAC3BC,SAAS,EAAE,KAAK;MAChBC,OAAO,EAAE,KAAK;MACdC,QAAQ,EAAE,MAAM;MAChBC,iBAAiB,EAAE,MAAM;MACzBC,aAAa,EAAE,MAAM;MACrBC,gBAAgB,EAAE,QAAQ;MAC1BC,gBAAgB,EAAE,IAAI;MAAE;MACxBC,QAAQ,EAAE;QACRC,SAAS,EAAE,EAAE;QACbC,QAAQ,EAAE,EAAE;QACZC,OAAO,EAAE,IAAI;QACbC,UAAU,EAAE,kBAAkB;QAC9BC,KAAK,EAAE,EAAE;QACTC,IAAI,EAAE;MACR,CAAC;MACDC,QAAQ,EAAE,CACR;QAAEC,EAAE,EAAE,YAAY;QAAEC,IAAI,EAAE,YAAY;QAAEC,IAAI,EAAE;MAAoB,CAAC,EACnE;QAAEF,EAAE,EAAE,kBAAkB;QAAEC,IAAI,EAAE,kBAAkB;QAAEC,IAAI,EAAE;MAAyB,CAAC,EACpF;QAAEF,EAAE,EAAE,eAAe;QAAEC,IAAI,EAAE,eAAe;QAAEC,IAAI,EAAE;MAAkB,CAAC,EACvE;QAAEF,EAAE,EAAE,UAAU;QAAEC,IAAI,EAAE,UAAU;QAAEC,IAAI,EAAE;MAAkB,EAC7D;MACDC,aAAa,EAAE,CACb;QACEH,EAAE,EAAE,CAAC;QACLI,KAAK,EAAE,8CAA8C;QACrDC,OAAO,EAAE,uGAAuG;QAChHC,IAAI,EAAE,kBAAkB;QACxBJ,IAAI,EAAE,sBAAsB;QAC5BK,MAAM,EAAE;MACV,CAAC,EACD;QACEP,EAAE,EAAE,CAAC;QACLI,KAAK,EAAE,wCAAwC;QAC/CC,OAAO,EAAE,mGAAmG;QAC5GC,IAAI,EAAE,kBAAkB;QACxBJ,IAAI,EAAE,2BAA2B;QACjCK,MAAM,EAAE;MACV,CAAC,EACD;QACEP,EAAE,EAAE,CAAC;QACLI,KAAK,EAAE,+CAA+C;QACtDC,OAAO,EAAE,0FAA0F;QACnGC,IAAI,EAAE,kBAAkB;QACxBJ,IAAI,EAAE,iBAAiB;QACvBK,MAAM,EAAE;MACV,EACD;MAEDC,oBAAoB,EAAE,CACpB;QACER,EAAE,EAAE,CAAC;QACLlB,IAAI,EAAE,kBAAkB;QACxB2B,WAAW,EAAE,+BAA+B;QAC5CC,OAAO,EAAE;MACX,CAAC,EACD;QACEV,EAAE,EAAE,CAAC;QACLlB,IAAI,EAAE,sBAAsB;QAC5B2B,WAAW,EAAE,uCAAuC;QACpDC,OAAO,EAAE;MACX,CAAC,EACD;QACEV,EAAE,EAAE,CAAC;QACLlB,IAAI,EAAE,sBAAsB;QAC5B2B,WAAW,EAAE,gDAAgD;QAC7DC,OAAO,EAAE;MACX,EACD;MACDC,eAAe,EAAE,CACf;QACEX,EAAE,EAAE,CAAC;QACLlB,IAAI,EAAE,gBAAgB;QACtB2B,WAAW,EAAE,mDAAmD;QAChEC,OAAO,EAAE;MACX,CAAC,CACF;MACDE,WAAW,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,QAAQ;IACzC;EACF,CAAC;EACDC,QAAQ,EAAE;IACRC,WAAWA,CAAA,EAAG;MACZ,OAAO,IAAI,CAACtB,QAAQ,CAACK,KAAI,GAAI,IAAI,CAACL,QAAQ,CAACK,KAAK,CAACkB,OAAO,CAAC,eAAe,EAAE,WAAW,IAAI,WAAU;IACrG,CAAC;IACDC,kBAAkBA,CAAA,EAAG;MACnB;MACA;MACA,OAAO,IAAI,CAACC,UAAS;IACvB;EACF,CAAC;EACDC,OAAO,EAAE;IACP;IACAC,cAAcA,CAAA,EAAG;MACf;MACA,OAAOC,OAAO,CAAC,oCAAoC;IACrD,CAAC;IACDC,aAAaA,CAACC,SAAS,EAAE;MACvB,IAAI,CAACtC,aAAY,GAAIsC,SAAQ;IAC/B,CAAC;IACDC,UAAUA,CAAA,EAAG;MACX;MACA,IAAI,CAAChC,gBAAe,GAAIiC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAC,IAAI,CAAClC,QAAQ,CAAC;MAChE,IAAI,CAACP,SAAQ,GAAI,IAAG;IACtB,CAAC;IACD0C,UAAUA,CAAA,EAAG;MACX,IAAI,CAAC1C,SAAQ,GAAI,KAAI;MACrB;MACA,IAAI,IAAI,CAACM,gBAAgB,EAAE;QACzB,IAAI,CAACC,QAAO,GAAIgC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAC,IAAI,CAACnC,gBAAgB,CAAC;MAClE;IACF,CAAC;IACD,MAAMqC,aAAaA,CAAA,EAAG;MACpB,IAAI,IAAI,CAAC1C,OAAO,EAAE;;MAElB;MACA,MAAM2C,KAAI,GAAIC,YAAY,CAACC,OAAO,CAAC,OAAO;MAC1C,IAAI,CAACF,KAAK,EAAE;QACVG,KAAK,CAAC,mCAAmC;QACzC,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,QAAQ;QAC1B;MACF;MAEA,IAAI,CAAChD,OAAM,GAAI,IAAG;MAClB,IAAI;QACF,MAAMiD,SAAQ,GAAI;UAChBtC,KAAK,EAAE,IAAI,CAACL,QAAQ,CAACK,KAAI,IAAK;QAChC;QAEA,MAAMuC,WAAU,GAAI;UAClBzC,OAAO,EAAE,IAAI,CAACH,QAAQ,CAACG,OAAM,IAAK,IAAI;UACtCC,UAAU,EAAE,IAAI,CAACJ,QAAQ,CAACI,UAAS,IAAK;QAC1C;QAEA,MAAMyC,MAAK,GAAI,MAAMxD,aAAa,CAAC;UACjCsD,SAAS;UACTC;QACF,CAAC;QAED,IAAIC,MAAM,CAACC,IAAG,KAAM,CAAC,EAAE;UACrBN,KAAK,CAAC,YAAY;UAClB,IAAI,CAAC/C,SAAQ,GAAI,KAAI;UACrB;UACA,MAAM,IAAI,CAACsD,YAAY,CAAC;QAC1B,OAAO;UACLP,KAAK,CAACK,MAAM,CAACG,GAAE,IAAK,UAAU;QAChC;MACF,EAAE,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,OAAO,EAAEA,KAAK;QAC5B,IAAIA,KAAK,CAACE,OAAM,IAAKF,KAAK,CAACE,OAAO,CAACC,QAAQ,CAAC,KAAK,CAAC,EAAE;UAClDZ,KAAK,CAAC,mCAAmC;UACzC,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,QAAQ;QAC5B,OAAO;UACLF,KAAK,CAACS,KAAK,CAACE,OAAM,IAAK,wCAAwC;QACjE;MACF,UAAU;QACR,IAAI,CAACzD,OAAM,GAAI,KAAI;MACrB;IACF,CAAC;IACD2D,cAAcA,CAAA,EAAG;MACfb,KAAK,CAAC,gBAAgB;IACxB,CAAC;IACDc,WAAWA,CAAA,EAAG;MACZd,KAAK,CAAC,gBAAgB;IACxB,CAAC;IACDe,aAAaA,CAAA,EAAG;MACd,IAAI,CAAC5C,aAAa,CAAC6C,OAAO,CAACC,YAAW,IAAK;QACzCA,YAAY,CAAC1C,MAAK,GAAI,KAAI;MAC5B,CAAC;MACDyB,KAAK,CAAC,YAAY;IACpB,CAAC;IACDkB,cAAcA,CAACC,IAAI,EAAE;MACnB,IAAI,CAAChE,QAAO,GAAIgE,IAAG;IACrB,CAAC;IACDC,cAAcA,CAACpD,EAAE,EAAE;MACjB,IAAIqD,OAAO,CAAC,qDAAqD,CAAC,EAAE;QAClE,IAAI,CAACC,SAAQ,GAAI,IAAI,CAACA,SAAS,CAACC,MAAM,CAACC,QAAO,IAAKA,QAAQ,CAACxD,EAAC,KAAMA,EAAE;MACvE;IACF,CAAC;IACDyD,gBAAgBA,CAAA,EAAG;MACjB;MACA;MACAf,OAAO,CAACgB,GAAG,CAAC,YAAY,EAAE,IAAI,CAACtE,iBAAiB;IAClD,CAAC;IACDuE,aAAaA,CAACC,OAAO,EAAE;MACrBlB,OAAO,CAACgB,GAAG,CAAC,OAAO,EAAEE,OAAO;MAC5B;IACF,CAAC;IACDC,WAAWA,CAACC,KAAK,EAAE;MACjB,IAAI,CAACzE,aAAY,GAAIyE,KAAI;MACzB;MACA9B,KAAK,CAAC,aAAa8B,KAAK,EAAE;IAC5B,CAAC;IACDC,cAAcA,CAAA,EAAG;MACf;MACA/B,KAAK,CAAC,aAAa,IAAI,CAAC1C,gBAAgB,EAAE;IAC5C,CAAC;IACD0E,mBAAmBA,CAAA,EAAG;MACpB;MACA,MAAMC,KAAI,GAAIC,QAAQ,CAACC,aAAa,CAAC,OAAO;MAC5CF,KAAK,CAACG,IAAG,GAAI,MAAK;MAClBH,KAAK,CAACI,MAAK,GAAI,SAAQ;MACvBJ,KAAK,CAACK,QAAO,GAAKC,CAAC,IAAK;QACtB,MAAMC,IAAG,GAAID,CAAC,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC;QAC7B,IAAIF,IAAI,EAAE;UACR,MAAMG,MAAK,GAAI,IAAIC,UAAU,CAAC;UAC9BD,MAAM,CAACE,MAAK,GAAKC,KAAK,IAAK;YACzB;YACAZ,QAAQ,CAACa,aAAa,CAAC,SAAS,CAAC,CAACC,GAAE,GAAIF,KAAK,CAACL,MAAM,CAACpC,MAAK;UAC5D;UACAsC,MAAM,CAACM,aAAa,CAACT,IAAI;QAC3B;MACF;MACAP,KAAK,CAACiB,KAAK,CAAC;IACd,CAAC;IAED;IACA,MAAM3C,YAAYA,CAAA,EAAG;MACnB,IAAI,CAACrD,OAAM,GAAI,IAAG;MAClB,IAAI;QACF,MAAM2C,KAAI,GAAIC,YAAY,CAACC,OAAO,CAAC,OAAO;QAC1C,IAAI,CAACF,KAAK,EAAE;UACVa,OAAO,CAACgB,GAAG,CAAC,gCAAgC;UAC5C;UACA,MAAMyB,SAAQ,GAAIrD,YAAY,CAACC,OAAO,CAAC,UAAU;UACjD,IAAIoD,SAAS,EAAE;YACb,IAAI;cACF,MAAMC,UAAS,GAAI5D,IAAI,CAACC,KAAK,CAAC0D,SAAS;cACvC,IAAI,CAAC3F,QAAO,GAAI;gBACdC,SAAS,EAAE2F,UAAU,CAAC3F,SAAQ,IAAK2F,UAAU,CAACtG,IAAG,IAAK,EAAE;gBACxDY,QAAQ,EAAE0F,UAAU,CAAC1F,QAAO,IAAK,EAAE;gBACnCG,KAAK,EAAEuF,UAAU,CAACvF,KAAI,IAAK,EAAE;gBAC7BC,IAAI,EAAEsF,UAAU,CAACtF,IAAG,IAAK,SAAS;gBAClCH,OAAO,EAAE,IAAI;gBACbC,UAAU,EAAE;cACd;cACA8C,OAAO,CAACgB,GAAG,CAAC,uBAAuB,EAAE,IAAI,CAAClE,QAAQ;YACpD,EAAE,OAAO6F,UAAU,EAAE;cACnB3C,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAE4C,UAAU;YACnD;UACF;UACA;QACF;QAEA3C,OAAO,CAACgB,GAAG,CAAC,iBAAiB;QAC7B,MAAMrB,MAAK,GAAI,MAAMzD,UAAU,CAAC;QAEhC,IAAIyD,MAAM,CAACC,IAAG,KAAM,KAAKD,MAAM,CAACtD,IAAI,EAAE;UACpC,MAAMA,IAAG,GAAIsD,MAAM,CAACtD,IAAG;UACvB,IAAI,CAACS,QAAO,GAAI;YACdC,SAAS,EAAEV,IAAI,CAACU,SAAQ,IAAKV,IAAI,CAACD,IAAG,IAAK,EAAE;YAC5CY,QAAQ,EAAEX,IAAI,CAACW,QAAO,IAAK,EAAE;YAC7BG,KAAK,EAAEd,IAAI,CAACc,KAAI,IAAK,EAAE;YACvBC,IAAI,EAAEf,IAAI,CAACe,IAAG,IAAK,SAAS;YAC5BH,OAAO,EAAE,IAAI;YACbC,UAAU,EAAE;UACd;UACA8C,OAAO,CAACgB,GAAG,CAAC,cAAc,EAAE,IAAI,CAAClE,QAAQ;;UAEzC;UACAsC,YAAY,CAACwD,OAAO,CAAC,UAAU,EAAE9D,IAAI,CAACE,SAAS,CAAC,IAAI,CAAClC,QAAQ,CAAC;QAChE,OAAO;UACLkD,OAAO,CAACgB,GAAG,CAAC,8BAA8B;UAC1C;UACA,MAAMyB,SAAQ,GAAIrD,YAAY,CAACC,OAAO,CAAC,UAAU;UACjD,IAAIoD,SAAS,EAAE;YACb,IAAI;cACF,MAAMC,UAAS,GAAI5D,IAAI,CAACC,KAAK,CAAC0D,SAAS;cACvC,IAAI,CAAC3F,QAAO,GAAI;gBACdC,SAAS,EAAE2F,UAAU,CAAC3F,SAAQ,IAAK2F,UAAU,CAACtG,IAAG,IAAK,EAAE;gBACxDY,QAAQ,EAAE0F,UAAU,CAAC1F,QAAO,IAAK,EAAE;gBACnCG,KAAK,EAAEuF,UAAU,CAACvF,KAAI,IAAK,EAAE;gBAC7BC,IAAI,EAAEsF,UAAU,CAACtF,IAAG,IAAK,IAAI;gBAC7BH,OAAO,EAAE,IAAI;gBACbC,UAAU,EAAE;cACd;YACF,EAAE,OAAOyF,UAAU,EAAE;cACnB3C,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAE4C,UAAU;YACnD;UACF;QACF;MACF,EAAE,OAAO5C,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,WAAW,EAAEA,KAAK;QAChC;QACA,MAAM0C,SAAQ,GAAIrD,YAAY,CAACC,OAAO,CAAC,UAAU;QACjD,IAAIoD,SAAS,EAAE;UACb,IAAI;YACF,MAAMC,UAAS,GAAI5D,IAAI,CAACC,KAAK,CAAC0D,SAAS;YACvC,IAAI,CAAC3F,QAAO,GAAI;cACdC,SAAS,EAAE2F,UAAU,CAAC3F,SAAQ,IAAK2F,UAAU,CAACtG,IAAG,IAAK,EAAE;cACxDY,QAAQ,EAAE0F,UAAU,CAAC1F,QAAO,IAAK,EAAE;cACnCG,KAAK,EAAEuF,UAAU,CAACvF,KAAI,IAAK,EAAE;cAC7BC,IAAI,EAAEsF,UAAU,CAACtF,IAAG,IAAK,IAAI;cAC7BH,OAAO,EAAE,IAAI;cACbC,UAAU,EAAE;YACd;YACA8C,OAAO,CAACgB,GAAG,CAAC,4BAA4B,EAAE,IAAI,CAAClE,QAAQ;UACzD,EAAE,OAAO6F,UAAU,EAAE;YACnB3C,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAE4C,UAAU;UACnD;QACF;MACF,UAAU;QACR,IAAI,CAACnG,OAAM,GAAI,KAAI;MACrB;IACF;EACF,CAAC;EACD,MAAMqG,OAAOA,CAAA,EAAG;IACd7C,OAAO,CAACgB,GAAG,CAAC,aAAa;IACzB,MAAM,IAAI,CAACnB,YAAY,CAAC;EAC1B;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}