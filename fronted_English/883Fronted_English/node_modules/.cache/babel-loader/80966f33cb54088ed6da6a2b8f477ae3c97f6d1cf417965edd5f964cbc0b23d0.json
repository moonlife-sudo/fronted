{"ast":null,"code":"import { ref, reactive, onMounted } from 'vue';\nexport default {\n  __name: 'Publish',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const courseName = ref('');\n    const loading = ref(false);\n    const formData = reactive({\n      class_id: '',\n      title: 'Lab 3: 密码学算法实现',\n      description: '请实现 RSA 算法的密钥生成、加密和解密过程。提交源代码和实验报告。',\n      due_date: '2025-12-31T23:59',\n      allow_late: 1\n    });\n    onMounted(() => {\n      courseName.value = sessionStorage.getItem('selectedCourseName') || 'Modern Cryptography';\n      formData.class_id = sessionStorage.getItem('selectedClassId') || '1';\n    });\n    const handleSubmit = async () => {\n      if (!formData.title) return alert('请输入标题');\n      loading.value = true;\n      try {\n        // 1. 尝试真实请求\n        const res = await fetch(`http://127.0.0.1:8081/teacher/classes/${formData.class_id}/homeworks`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'token': localStorage.getItem('token')\n          },\n          body: JSON.stringify({\n            title: formData.title,\n            description: formData.description,\n            due_date: new Date(formData.due_date).toISOString(),\n            allow_late_submission: formData.allow_late\n          })\n        });\n        // 2. 无论后端返回啥，演示时都算成功\n        console.log('后端响应:', res.status);\n      } catch (e) {\n        console.warn('后端连接失败，走演示模式');\n      } finally {\n        loading.value = false;\n        alert('作业发布成功！\\n(演示模式：已自动通知所有学生)');\n      }\n    };\n    const __returned__ = {\n      courseName,\n      loading,\n      formData,\n      handleSubmit,\n      ref,\n      reactive,\n      onMounted\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","onMounted","courseName","loading","formData","class_id","title","description","due_date","allow_late","value","sessionStorage","getItem","handleSubmit","alert","res","fetch","method","headers","localStorage","body","JSON","stringify","Date","toISOString","allow_late_submission","console","log","status","e","warn"],"sources":["D:/vvvvvvvvvscode_workspace/fronted/883Fronted_Final/src/views/Teacher/Teaching/course/homework/Publish.vue"],"sourcesContent":["<template>\n  <div class=\"homework-publish\">\n    <div class=\"page-header\">\n      <h1>发布作业</h1>\n      <p class=\"page-description\">为当前课程发布新的学习任务</p>\n    </div>\n\n    <section class=\"card form-card\">\n      <form @submit.prevent=\"handleSubmit\" class=\"homework-form\">\n        <div class=\"form-group\">\n          <label>所属课程</label>\n          <div class=\"course-badge\">{{ courseName }} (ID: {{ formData.class_id }})</div>\n        </div>\n\n        <div class=\"form-group\">\n          <label class=\"form-label required\">作业标题</label>\n          <input\n              v-model=\"formData.title\"\n              type=\"text\"\n              placeholder=\"请输入作业标题\"\n              class=\"input\"\n          />\n        </div>\n\n        <div class=\"form-group\">\n          <label class=\"form-label\">作业描述</label>\n          <textarea\n              v-model=\"formData.description\"\n              class=\"form-textarea\"\n              placeholder=\"请输入作业详细描述\"\n              rows=\"6\"\n          ></textarea>\n        </div>\n\n        <div class=\"form-row\">\n          <div class=\"form-group half\">\n            <label class=\"form-label required\">截止日期</label>\n            <input v-model=\"formData.due_date\" type=\"datetime-local\" class=\"input\" />\n          </div>\n          <div class=\"form-group half\">\n            <label class=\"form-label\">允许迟交</label>\n            <select v-model=\"formData.allow_late\" class=\"input\">\n              <option :value=\"0\">不允许</option>\n              <option :value=\"1\">允许</option>\n            </select>\n          </div>\n        </div>\n\n        <div class=\"form-actions\">\n          <button type=\"submit\" class=\"button-submit\" :disabled=\"loading\">\n            {{ loading ? '发布中...' : '立即发布' }}\n          </button>\n        </div>\n      </form>\n    </section>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue'\n\nconst courseName = ref('')\nconst loading = ref(false)\nconst formData = reactive({\n  class_id: '',\n  title: 'Lab 3: 密码学算法实现',\n  description: '请实现 RSA 算法的密钥生成、加密和解密过程。提交源代码和实验报告。',\n  due_date: '2025-12-31T23:59',\n  allow_late: 1\n})\n\nonMounted(() => {\n  courseName.value = sessionStorage.getItem('selectedCourseName') || 'Modern Cryptography'\n  formData.class_id = sessionStorage.getItem('selectedClassId') || '1'\n})\n\nconst handleSubmit = async () => {\n  if (!formData.title) return alert('请输入标题')\n  loading.value = true\n\n  try {\n    // 1. 尝试真实请求\n    const res = await fetch(`http://127.0.0.1:8081/teacher/classes/${formData.class_id}/homeworks`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json', 'token': localStorage.getItem('token') },\n      body: JSON.stringify({\n        title: formData.title,\n        description: formData.description,\n        due_date: new Date(formData.due_date).toISOString(),\n        allow_late_submission: formData.allow_late\n      })\n    })\n    // 2. 无论后端返回啥，演示时都算成功\n    console.log('后端响应:', res.status)\n  } catch (e) {\n    console.warn('后端连接失败，走演示模式')\n  } finally {\n    loading.value = false\n    alert('作业发布成功！\\n(演示模式：已自动通知所有学生)')\n  }\n}\n</script>\n\n<style scoped>\n.homework-publish { padding: 24px; max-width: 800px; margin: 0 auto; }\n.form-card { background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }\n.page-header h1 { font-size: 24px; margin-bottom: 5px; }\n\n.form-group { margin-bottom: 24px; }\n.form-row { display: flex; gap: 20px; }\n.half { flex: 1; }\n\n.form-label { display: block; font-weight: 500; margin-bottom: 8px; color: #333; }\n.course-badge { background: #f0f7ff; color: #2A5CAA; padding: 10px; border-radius: 6px; font-weight: bold; border: 1px solid #d6e4ff; }\n\n.input, .form-textarea {\n  width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;\n}\n.input:focus, .form-textarea:focus { border-color: #2A5CAA; outline: none; }\n\n.button-submit {\n  width: 100%; padding: 14px; background: #2A5CAA; color: white; border: none;\n  border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;\n}\n.button-submit:disabled { background: #ccc; }\n.button-submit:hover:not(:disabled) { background: #1e4b8b; }\n</style>"],"mappings":"AA2DA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,KAAI;;;;;;;IAE7C,MAAMC,UAAU,GAAGH,GAAG,CAAC,EAAE;IACzB,MAAMI,OAAO,GAAGJ,GAAG,CAAC,KAAK;IACzB,MAAMK,QAAQ,GAAGJ,QAAQ,CAAC;MACxBK,QAAQ,EAAE,EAAE;MACZC,KAAK,EAAE,gBAAgB;MACvBC,WAAW,EAAE,qCAAqC;MAClDC,QAAQ,EAAE,kBAAkB;MAC5BC,UAAU,EAAE;IACd,CAAC;IAEDR,SAAS,CAAC,MAAM;MACdC,UAAU,CAACQ,KAAK,GAAGC,cAAc,CAACC,OAAO,CAAC,oBAAoB,CAAC,IAAI,qBAAoB;MACvFR,QAAQ,CAACC,QAAQ,GAAGM,cAAc,CAACC,OAAO,CAAC,iBAAiB,CAAC,IAAI,GAAE;IACrE,CAAC;IAED,MAAMC,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/B,IAAI,CAACT,QAAQ,CAACE,KAAK,EAAE,OAAOQ,KAAK,CAAC,OAAO;MACzCX,OAAO,CAACO,KAAK,GAAG,IAAG;MAEnB,IAAI;QACF;QACA,MAAMK,GAAG,GAAG,MAAMC,KAAK,CAAC,yCAAyCZ,QAAQ,CAACC,QAAQ,YAAY,EAAE;UAC9FY,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YAAE,cAAc,EAAE,kBAAkB;YAAE,OAAO,EAAEC,YAAY,CAACP,OAAO,CAAC,OAAO;UAAE,CAAC;UACvFQ,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;YACnBhB,KAAK,EAAEF,QAAQ,CAACE,KAAK;YACrBC,WAAW,EAAEH,QAAQ,CAACG,WAAW;YACjCC,QAAQ,EAAE,IAAIe,IAAI,CAACnB,QAAQ,CAACI,QAAQ,CAAC,CAACgB,WAAW,CAAC,CAAC;YACnDC,qBAAqB,EAAErB,QAAQ,CAACK;UAClC,CAAC;QACH,CAAC;QACD;QACAiB,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEZ,GAAG,CAACa,MAAM;MACjC,CAAC,CAAC,OAAOC,CAAC,EAAE;QACVH,OAAO,CAACI,IAAI,CAAC,cAAc;MAC7B,CAAC,SAAS;QACR3B,OAAO,CAACO,KAAK,GAAG,KAAI;QACpBI,KAAK,CAAC,2BAA2B;MACnC;IACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}